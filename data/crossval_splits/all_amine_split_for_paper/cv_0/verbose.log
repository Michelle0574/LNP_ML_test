Command line
python main_script.py train all_amine_split_for_paper --epochs 10
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 9,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [0.05, 0.05, 0.05, 0.05, 0.95, 0.95, 0.95, 0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/test_extra_x.csv'],
 'separate_test_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/valid_extra_x.csv'],
 'separate_val_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['Biodistribution_heart',
                    'Biodistribution_kidney',
                    'Biodistribution_liver',
                    'Biodistribution_lung',
                    'Biodistribution_lymph_nodes',
                    'Biodistribution_muscle',
                    'Biodistribution_spleen',
                    'quantified_delivery',
                    'quantified_total_luminescence'],
 'target_weights': None,
 'task_names': ['Biodistribution_heart',
                'Biodistribution_kidney',
                'Biodistribution_liver',
                'Biodistribution_lung',
                'Biodistribution_lymph_nodes',
                'Biodistribution_muscle',
                'Biodistribution_spleen',
                'quantified_delivery',
                'quantified_total_luminescence'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 9
Fold 0
Splitting data with seed 42
Total size = 5,977 | train size = 5,977 | val size = 2,235 | test size = 1,739
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=621, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=9, bias=True)
  )
)
Number of parameters = 1,628,409
Moving model to cuda
Epoch 0
Loss = 1.1060e+00, PNorm = 52.2049, GNorm = 3.4368, lr_0 = 1.4160e-04
Loss = 1.0196e+00, PNorm = 52.2062, GNorm = 2.3078, lr_0 = 1.7941e-04
Loss = 9.3796e-01, PNorm = 52.2094, GNorm = 2.1546, lr_0 = 2.1723e-04
Loss = 9.6021e-01, PNorm = 52.2137, GNorm = 3.5080, lr_0 = 2.5504e-04
Loss = 1.0643e+00, PNorm = 52.2204, GNorm = 1.4899, lr_0 = 2.9286e-04
Loss = 1.0294e+00, PNorm = 52.2291, GNorm = 1.9972, lr_0 = 3.3067e-04
Loss = 1.0932e+00, PNorm = 52.2425, GNorm = 3.8466, lr_0 = 3.6849e-04
Loss = 1.0306e+00, PNorm = 52.2548, GNorm = 1.7007, lr_0 = 4.0630e-04
Loss = 8.8657e-01, PNorm = 52.2698, GNorm = 1.3419, lr_0 = 4.4412e-04
Loss = 8.6131e-01, PNorm = 52.2847, GNorm = 1.4164, lr_0 = 4.8193e-04
Loss = 8.1105e-01, PNorm = 52.3014, GNorm = 0.9902, lr_0 = 5.1975e-04
Validation rmse = 0.173719
Epoch 1
Loss = 1.3061e+00, PNorm = 52.3241, GNorm = 2.1557, lr_0 = 5.6134e-04
Loss = 8.7573e-01, PNorm = 52.3429, GNorm = 1.6119, lr_0 = 5.9916e-04
Loss = 9.5342e-01, PNorm = 52.3669, GNorm = 1.1605, lr_0 = 6.3697e-04
Loss = 9.3487e-01, PNorm = 52.3910, GNorm = 1.3502, lr_0 = 6.7479e-04
Loss = 9.4820e-01, PNorm = 52.4239, GNorm = 1.0012, lr_0 = 7.1261e-04
Loss = 8.5142e-01, PNorm = 52.4561, GNorm = 1.5409, lr_0 = 7.5042e-04
Loss = 8.8285e-01, PNorm = 52.4860, GNorm = 1.4032, lr_0 = 7.8824e-04
Loss = 9.6966e-01, PNorm = 52.5165, GNorm = 1.2629, lr_0 = 8.2605e-04
Loss = 8.4234e-01, PNorm = 52.5449, GNorm = 1.4067, lr_0 = 8.6387e-04
Loss = 8.8966e-01, PNorm = 52.5697, GNorm = 2.3351, lr_0 = 9.0168e-04
Loss = 8.9659e-01, PNorm = 52.6062, GNorm = 1.2111, lr_0 = 9.3950e-04
Loss = 1.0518e+00, PNorm = 52.6463, GNorm = 1.4877, lr_0 = 9.7731e-04
Validation rmse = 0.174010
Epoch 2
Loss = 1.4294e+00, PNorm = 52.6822, GNorm = 1.2353, lr_0 = 9.9037e-04
Loss = 7.6034e-01, PNorm = 52.7340, GNorm = 1.1895, lr_0 = 9.6671e-04
Loss = 9.6036e-01, PNorm = 52.7741, GNorm = 1.3737, lr_0 = 9.4360e-04
Loss = 8.7971e-01, PNorm = 52.8184, GNorm = 0.7884, lr_0 = 9.2106e-04
Loss = 9.9691e-01, PNorm = 52.8574, GNorm = 1.1881, lr_0 = 8.9905e-04
Loss = 8.0342e-01, PNorm = 52.8886, GNorm = 0.8130, lr_0 = 8.7756e-04
Loss = 8.0135e-01, PNorm = 52.9159, GNorm = 0.8201, lr_0 = 8.5659e-04
Loss = 9.1453e-01, PNorm = 52.9591, GNorm = 1.2258, lr_0 = 8.3612e-04
Loss = 8.5976e-01, PNorm = 52.9986, GNorm = 0.9640, lr_0 = 8.1614e-04
Loss = 9.5791e-01, PNorm = 53.0512, GNorm = 0.7855, lr_0 = 7.9664e-04
Loss = 8.2519e-01, PNorm = 53.0865, GNorm = 1.0247, lr_0 = 7.7760e-04
Loss = 8.4128e-01, PNorm = 53.1228, GNorm = 1.1397, lr_0 = 7.5902e-04
Validation rmse = 0.178007
Epoch 3
Loss = 8.3753e-01, PNorm = 53.1568, GNorm = 0.8830, lr_0 = 7.3909e-04
Loss = 8.4582e-01, PNorm = 53.1972, GNorm = 1.6580, lr_0 = 7.2143e-04
Loss = 9.3449e-01, PNorm = 53.2245, GNorm = 0.8370, lr_0 = 7.0419e-04
Loss = 9.1139e-01, PNorm = 53.2694, GNorm = 0.9077, lr_0 = 6.8736e-04
Loss = 8.5583e-01, PNorm = 53.3107, GNorm = 0.9812, lr_0 = 6.7094e-04
Loss = 7.9307e-01, PNorm = 53.3580, GNorm = 0.9965, lr_0 = 6.5490e-04
Loss = 7.4797e-01, PNorm = 53.3963, GNorm = 0.7444, lr_0 = 6.3925e-04
Loss = 7.2857e-01, PNorm = 53.4226, GNorm = 0.8416, lr_0 = 6.2398e-04
Loss = 8.3483e-01, PNorm = 53.4575, GNorm = 0.9143, lr_0 = 6.0907e-04
Loss = 7.1559e-01, PNorm = 53.4843, GNorm = 1.1742, lr_0 = 5.9451e-04
Loss = 9.9055e-01, PNorm = 53.5245, GNorm = 1.1824, lr_0 = 5.8030e-04
Loss = 8.1644e-01, PNorm = 53.5596, GNorm = 1.4280, lr_0 = 5.6644e-04
Validation rmse = 0.176481
Epoch 4
Loss = 4.6384e-01, PNorm = 53.5900, GNorm = 0.9477, lr_0 = 5.5290e-04
Loss = 8.3858e-01, PNorm = 53.6184, GNorm = 1.2500, lr_0 = 5.3969e-04
Loss = 8.5262e-01, PNorm = 53.6561, GNorm = 1.3043, lr_0 = 5.2679e-04
Loss = 6.4462e-01, PNorm = 53.6849, GNorm = 0.7456, lr_0 = 5.1420e-04
Loss = 8.9176e-01, PNorm = 53.6989, GNorm = 0.8274, lr_0 = 5.0192e-04
Loss = 7.7367e-01, PNorm = 53.7319, GNorm = 1.1291, lr_0 = 4.8992e-04
Loss = 1.0455e+00, PNorm = 53.7622, GNorm = 1.2734, lr_0 = 4.7821e-04
Loss = 8.5633e-01, PNorm = 53.7971, GNorm = 1.7199, lr_0 = 4.6679e-04
Loss = 6.3459e-01, PNorm = 53.8170, GNorm = 1.3384, lr_0 = 4.5563e-04
Loss = 8.2935e-01, PNorm = 53.8490, GNorm = 1.3524, lr_0 = 4.4474e-04
Loss = 7.4044e-01, PNorm = 53.8748, GNorm = 0.9102, lr_0 = 4.3412e-04
Loss = 8.1618e-01, PNorm = 53.9094, GNorm = 1.0709, lr_0 = 4.2374e-04
Validation rmse = 0.170625
Epoch 5
Loss = 6.2611e-01, PNorm = 53.9349, GNorm = 0.8231, lr_0 = 4.1262e-04
Loss = 7.7562e-01, PNorm = 53.9645, GNorm = 1.1151, lr_0 = 4.0276e-04
Loss = 8.1215e-01, PNorm = 53.9823, GNorm = 0.7561, lr_0 = 3.9313e-04
Loss = 8.4894e-01, PNorm = 54.0012, GNorm = 0.7024, lr_0 = 3.8374e-04
Loss = 8.6056e-01, PNorm = 54.0235, GNorm = 1.1716, lr_0 = 3.7457e-04
Loss = 7.3842e-01, PNorm = 54.0501, GNorm = 0.9231, lr_0 = 3.6562e-04
Loss = 7.2241e-01, PNorm = 54.0670, GNorm = 0.9204, lr_0 = 3.5688e-04
Loss = 7.4757e-01, PNorm = 54.0744, GNorm = 1.4401, lr_0 = 3.4835e-04
Loss = 7.4213e-01, PNorm = 54.0943, GNorm = 0.8760, lr_0 = 3.4003e-04
Loss = 8.4953e-01, PNorm = 54.1172, GNorm = 0.9358, lr_0 = 3.3190e-04
Loss = 7.9501e-01, PNorm = 54.1348, GNorm = 1.1371, lr_0 = 3.2397e-04
Loss = 7.3418e-01, PNorm = 54.1427, GNorm = 1.0344, lr_0 = 3.1623e-04
Validation rmse = 0.171015
Epoch 6
Loss = 8.4507e-01, PNorm = 54.1630, GNorm = 1.0143, lr_0 = 3.0867e-04
Loss = 9.0812e-01, PNorm = 54.1839, GNorm = 1.5440, lr_0 = 3.0129e-04
Loss = 7.2003e-01, PNorm = 54.1989, GNorm = 1.0941, lr_0 = 2.9409e-04
Loss = 7.6536e-01, PNorm = 54.2174, GNorm = 1.5282, lr_0 = 2.8707e-04
Loss = 8.8295e-01, PNorm = 54.2315, GNorm = 1.8431, lr_0 = 2.8021e-04
Loss = 7.5266e-01, PNorm = 54.2468, GNorm = 1.2188, lr_0 = 2.7351e-04
Loss = 6.9439e-01, PNorm = 54.2586, GNorm = 1.5643, lr_0 = 2.6697e-04
Loss = 7.2683e-01, PNorm = 54.2691, GNorm = 1.3661, lr_0 = 2.6060e-04
Loss = 6.6382e-01, PNorm = 54.2842, GNorm = 1.0663, lr_0 = 2.5437e-04
Loss = 8.9021e-01, PNorm = 54.2989, GNorm = 1.1976, lr_0 = 2.4829e-04
Loss = 7.3734e-01, PNorm = 54.3080, GNorm = 1.1871, lr_0 = 2.4236e-04
Loss = 5.8908e-01, PNorm = 54.3196, GNorm = 0.9875, lr_0 = 2.3656e-04
Validation rmse = 0.168862
Epoch 7
Loss = 6.8057e-01, PNorm = 54.3276, GNorm = 0.9747, lr_0 = 2.3035e-04
Loss = 6.6761e-01, PNorm = 54.3414, GNorm = 1.2606, lr_0 = 2.2485e-04
Loss = 6.3811e-01, PNorm = 54.3571, GNorm = 0.9827, lr_0 = 2.1948e-04
Loss = 6.7067e-01, PNorm = 54.3727, GNorm = 1.4600, lr_0 = 2.1423e-04
Loss = 8.1215e-01, PNorm = 54.3836, GNorm = 0.7065, lr_0 = 2.0911e-04
Loss = 7.0335e-01, PNorm = 54.3962, GNorm = 1.1161, lr_0 = 2.0411e-04
Loss = 9.3704e-01, PNorm = 54.4087, GNorm = 1.3723, lr_0 = 1.9924e-04
Loss = 8.0913e-01, PNorm = 54.4191, GNorm = 1.0143, lr_0 = 1.9448e-04
Loss = 7.7154e-01, PNorm = 54.4210, GNorm = 0.8550, lr_0 = 1.8983e-04
Loss = 8.0399e-01, PNorm = 54.4328, GNorm = 0.9194, lr_0 = 1.8529e-04
Loss = 6.7167e-01, PNorm = 54.4471, GNorm = 1.3347, lr_0 = 1.8086e-04
Loss = 7.6702e-01, PNorm = 54.4572, GNorm = 1.0195, lr_0 = 1.7654e-04
Validation rmse = 0.171655
Epoch 8
Loss = 6.4625e-01, PNorm = 54.4683, GNorm = 0.9413, lr_0 = 1.7232e-04
Loss = 6.6219e-01, PNorm = 54.4791, GNorm = 1.0895, lr_0 = 1.6821e-04
Loss = 8.2808e-01, PNorm = 54.4846, GNorm = 0.8485, lr_0 = 1.6419e-04
Loss = 6.7344e-01, PNorm = 54.4932, GNorm = 0.9639, lr_0 = 1.6026e-04
Loss = 8.7689e-01, PNorm = 54.5033, GNorm = 1.0499, lr_0 = 1.5643e-04
Loss = 7.3728e-01, PNorm = 54.5106, GNorm = 1.2737, lr_0 = 1.5269e-04
Loss = 6.8527e-01, PNorm = 54.5182, GNorm = 1.3872, lr_0 = 1.4905e-04
Loss = 7.1420e-01, PNorm = 54.5231, GNorm = 0.9953, lr_0 = 1.4548e-04
Loss = 7.8455e-01, PNorm = 54.5301, GNorm = 0.7001, lr_0 = 1.4201e-04
Loss = 7.8564e-01, PNorm = 54.5384, GNorm = 1.1598, lr_0 = 1.3861e-04
Loss = 6.2867e-01, PNorm = 54.5472, GNorm = 0.9561, lr_0 = 1.3530e-04
Loss = 7.5718e-01, PNorm = 54.5528, GNorm = 1.3818, lr_0 = 1.3207e-04
Validation rmse = 0.170941
Epoch 9
Loss = 8.4242e-01, PNorm = 54.5614, GNorm = 0.8078, lr_0 = 1.2860e-04
Loss = 8.4604e-01, PNorm = 54.5689, GNorm = 1.5716, lr_0 = 1.2553e-04
Loss = 7.1204e-01, PNorm = 54.5768, GNorm = 1.1314, lr_0 = 1.2253e-04
Loss = 8.5737e-01, PNorm = 54.5843, GNorm = 1.3430, lr_0 = 1.1960e-04
Loss = 7.1979e-01, PNorm = 54.5908, GNorm = 1.2084, lr_0 = 1.1674e-04
Loss = 6.8981e-01, PNorm = 54.5957, GNorm = 0.7926, lr_0 = 1.1395e-04
Loss = 7.2293e-01, PNorm = 54.6007, GNorm = 1.7735, lr_0 = 1.1123e-04
Loss = 7.0914e-01, PNorm = 54.6095, GNorm = 1.0832, lr_0 = 1.0857e-04
Loss = 6.4768e-01, PNorm = 54.6214, GNorm = 1.5011, lr_0 = 1.0598e-04
Loss = 6.2419e-01, PNorm = 54.6249, GNorm = 1.1212, lr_0 = 1.0344e-04
Loss = 6.3804e-01, PNorm = 54.6278, GNorm = 1.3234, lr_0 = 1.0097e-04
Loss = 6.7579e-01, PNorm = 54.6337, GNorm = 1.2532, lr_0 = 1.0000e-04
Validation rmse = 0.169906
Model 0 best validation rmse = 0.168862 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.302142
Ensemble test rmse = 0.152345
1-fold cross validation
	Seed 42 ==> test rmse = 0.152345
Overall test rmse = 0.152345 +/- 0.000000
Elapsed time = 0:01:26
Command line
python main_script.py train all_amine_split_for_paper --epochs 10
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/train_clf.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 15,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0_clf',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/test_extra_x.csv'],
 'separate_test_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/test_clf.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/valid_extra_x.csv'],
 'separate_val_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_0/valid_clf.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['Encapsulation_Efficiency_EE<50',
                    'Encapsulation_Efficiency_50<=EE<80',
                    'Encapsulation_Efficiency_80<EE<=100',
                    'Delivery_target_lymph_nodes',
                    'chronic_toxicity_none',
                    'acute_toxicity_none',
                    'acute_toxicity_present',
                    'Delivery_target_dendritic_cell',
                    'Delivery_target_generic_cell',
                    'Delivery_target_macrophage',
                    'Delivery_target_lung_epithelium',
                    'Delivery_target_liver',
                    'Delivery_target_lung',
                    'Delivery_target_spleen',
                    'Delivery_target_muscle'],
 'target_weights': None,
 'task_names': ['Encapsulation_Efficiency_EE<50',
                'Encapsulation_Efficiency_50<=EE<80',
                'Encapsulation_Efficiency_80<EE<=100',
                'Delivery_target_lymph_nodes',
                'chronic_toxicity_none',
                'acute_toxicity_none',
                'acute_toxicity_present',
                'Delivery_target_dendritic_cell',
                'Delivery_target_generic_cell',
                'Delivery_target_macrophage',
                'Delivery_target_lung_epithelium',
                'Delivery_target_liver',
                'Delivery_target_lung',
                'Delivery_target_spleen',
                'Delivery_target_muscle'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 15
Fold 0
Splitting data with seed 42
Class sizes
Encapsulation_Efficiency_EE<50 0: 84.86%, 1: 15.14%
Encapsulation_Efficiency_50<=EE<80 0: 68.92%, 1: 31.08%
Encapsulation_Efficiency_80<EE<=100 0: 46.22%, 1: 53.78%
Delivery_target_lymph_nodes 0: 95.81%, 1: 4.19%
chronic_toxicity_none 0: 82.07%, 1: 17.93%
acute_toxicity_none 0: 33.07%, 1: 66.93%
acute_toxicity_present 0: 98.01%, 1: 1.99%
Delivery_target_dendritic_cell 0: 99.90%, 1: 0.10%
Delivery_target_generic_cell 0: 31.34%, 1: 68.66%
Delivery_target_macrophage 0: 99.70%, 1: 0.30%
Delivery_target_lung_epithelium 0: 82.69%, 1: 17.31%
Delivery_target_liver 0: 92.95%, 1: 7.05%
Delivery_target_lung 0: 99.60%, 1: 0.40%
Delivery_target_spleen 0: 98.17%, 1: 1.83%
Delivery_target_muscle 0: 96.34%, 1: 3.66%
Total size = 6,059 | train size = 6,059 | val size = 2,235 | test size = 1,739
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=621, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=15, bias=True)
  )
)
Number of parameters = 1,632,015
Moving model to cuda
Epoch 0
Loss = 5.5898e-01, PNorm = 52.3241, GNorm = 0.8547, lr_0 = 1.4091e-04
Loss = 2.3494e-01, PNorm = 52.3550, GNorm = 0.5592, lr_0 = 1.7810e-04
Loss = 2.1257e-01, PNorm = 52.3640, GNorm = 0.3198, lr_0 = 2.1529e-04
Loss = 1.4835e-01, PNorm = 52.3741, GNorm = 0.2144, lr_0 = 2.5248e-04
Loss = 1.3298e-01, PNorm = 52.3923, GNorm = 0.3033, lr_0 = 2.8967e-04
Loss = 1.0023e-01, PNorm = 52.4152, GNorm = 0.2137, lr_0 = 3.2686e-04
Loss = 7.8893e-02, PNorm = 52.4384, GNorm = 0.2335, lr_0 = 3.6405e-04
Loss = 8.0757e-02, PNorm = 52.4657, GNorm = 0.2517, lr_0 = 4.0124e-04
Loss = 6.8166e-02, PNorm = 52.4962, GNorm = 0.2323, lr_0 = 4.3843e-04
Loss = 5.4612e-02, PNorm = 52.5250, GNorm = 0.2175, lr_0 = 4.7562e-04
Loss = 6.2437e-02, PNorm = 52.5552, GNorm = 0.1249, lr_0 = 5.1281e-04
Loss = 6.3042e-02, PNorm = 52.5798, GNorm = 0.2818, lr_0 = 5.5000e-04
Validation auc = 0.782565
Epoch 1
Loss = 6.0168e-02, PNorm = 52.6204, GNorm = 0.1999, lr_0 = 5.9091e-04
Loss = 5.1510e-02, PNorm = 52.6500, GNorm = 0.1816, lr_0 = 6.2810e-04
Loss = 5.4059e-02, PNorm = 52.6850, GNorm = 0.1665, lr_0 = 6.6529e-04
Loss = 5.8634e-02, PNorm = 52.7285, GNorm = 0.1915, lr_0 = 7.0248e-04
Loss = 5.4367e-02, PNorm = 52.7811, GNorm = 0.2282, lr_0 = 7.3967e-04
Loss = 3.9938e-02, PNorm = 52.8236, GNorm = 0.1317, lr_0 = 7.7686e-04
Loss = 4.1814e-02, PNorm = 52.8681, GNorm = 0.1400, lr_0 = 8.1405e-04
Loss = 3.7630e-02, PNorm = 52.9147, GNorm = 0.0992, lr_0 = 8.5124e-04
Loss = 4.2850e-02, PNorm = 52.9692, GNorm = 0.1334, lr_0 = 8.8843e-04
Loss = 4.1069e-02, PNorm = 53.0416, GNorm = 0.0804, lr_0 = 9.2562e-04
Loss = 4.3473e-02, PNorm = 53.0958, GNorm = 0.1209, lr_0 = 9.6281e-04
Loss = 6.6559e-02, PNorm = 53.1615, GNorm = 0.1205, lr_0 = 1.0000e-03
Validation auc = 0.806623
Epoch 2
Loss = 5.1165e-02, PNorm = 53.2674, GNorm = 0.1044, lr_0 = 9.7417e-04
Loss = 4.6409e-02, PNorm = 53.3622, GNorm = 0.1532, lr_0 = 9.5127e-04
Loss = 3.3193e-02, PNorm = 53.4386, GNorm = 0.0785, lr_0 = 9.2891e-04
Loss = 3.9267e-02, PNorm = 53.5286, GNorm = 0.1066, lr_0 = 9.0708e-04
Loss = 4.2847e-02, PNorm = 53.5961, GNorm = 0.0933, lr_0 = 8.8576e-04
Loss = 4.0367e-02, PNorm = 53.6606, GNorm = 0.0949, lr_0 = 8.6493e-04
Loss = 4.5379e-02, PNorm = 53.7183, GNorm = 0.1937, lr_0 = 8.4460e-04
Loss = 5.4406e-02, PNorm = 53.7696, GNorm = 0.2135, lr_0 = 8.2475e-04
Loss = 4.3792e-02, PNorm = 53.8260, GNorm = 0.1140, lr_0 = 8.0536e-04
Loss = 4.1841e-02, PNorm = 53.8884, GNorm = 0.1598, lr_0 = 7.8643e-04
Loss = 3.8908e-02, PNorm = 53.9520, GNorm = 0.0972, lr_0 = 7.6795e-04
Loss = 3.7198e-02, PNorm = 54.0128, GNorm = 0.0718, lr_0 = 7.4989e-04
Validation auc = 0.855165
Epoch 3
Loss = 3.6827e-02, PNorm = 54.0717, GNorm = 0.0692, lr_0 = 7.3053e-04
Loss = 4.0067e-02, PNorm = 54.1066, GNorm = 0.0633, lr_0 = 7.1336e-04
Loss = 3.9563e-02, PNorm = 54.1494, GNorm = 0.0646, lr_0 = 6.9659e-04
Loss = 4.3633e-02, PNorm = 54.1993, GNorm = 0.1127, lr_0 = 6.8021e-04
Loss = 3.4403e-02, PNorm = 54.2719, GNorm = 0.1285, lr_0 = 6.6422e-04
Loss = 4.5156e-02, PNorm = 54.3011, GNorm = 0.0929, lr_0 = 6.4861e-04
Loss = 4.0117e-02, PNorm = 54.3634, GNorm = 0.0938, lr_0 = 6.3336e-04
Loss = 2.6921e-02, PNorm = 54.4029, GNorm = 0.0599, lr_0 = 6.1848e-04
Loss = 3.6376e-02, PNorm = 54.4238, GNorm = 0.0568, lr_0 = 6.0394e-04
Loss = 3.6542e-02, PNorm = 54.4639, GNorm = 0.0893, lr_0 = 5.8974e-04
Loss = 3.4857e-02, PNorm = 54.4957, GNorm = 0.0913, lr_0 = 5.7588e-04
Loss = 4.0546e-02, PNorm = 54.5048, GNorm = 0.0640, lr_0 = 5.6234e-04
Validation auc = 0.868524
Epoch 4
Loss = 4.3401e-02, PNorm = 54.5522, GNorm = 0.0460, lr_0 = 5.4782e-04
Loss = 3.6290e-02, PNorm = 54.6105, GNorm = 0.1198, lr_0 = 5.3494e-04
Loss = 2.9983e-02, PNorm = 54.6557, GNorm = 0.1045, lr_0 = 5.2237e-04
Loss = 3.3535e-02, PNorm = 54.6681, GNorm = 0.0549, lr_0 = 5.1009e-04
Loss = 3.4639e-02, PNorm = 54.6913, GNorm = 0.0972, lr_0 = 4.9810e-04
Loss = 2.8637e-02, PNorm = 54.7324, GNorm = 0.0687, lr_0 = 4.8639e-04
Loss = 3.0862e-02, PNorm = 54.7438, GNorm = 0.1305, lr_0 = 4.7496e-04
Loss = 3.2856e-02, PNorm = 54.7835, GNorm = 0.0431, lr_0 = 4.6379e-04
Loss = 3.9880e-02, PNorm = 54.8106, GNorm = 0.1399, lr_0 = 4.5289e-04
Loss = 4.1202e-02, PNorm = 54.8544, GNorm = 0.0594, lr_0 = 4.4224e-04
Loss = 2.9121e-02, PNorm = 54.8911, GNorm = 0.0744, lr_0 = 4.3185e-04
Loss = 4.3744e-02, PNorm = 54.9294, GNorm = 0.1624, lr_0 = 4.2170e-04
Validation auc = 0.876995
Epoch 5
Loss = 3.2967e-02, PNorm = 54.9765, GNorm = 0.0867, lr_0 = 4.1081e-04
Loss = 4.5055e-02, PNorm = 55.0217, GNorm = 0.1022, lr_0 = 4.0115e-04
Loss = 3.2044e-02, PNorm = 55.0392, GNorm = 0.0706, lr_0 = 3.9172e-04
Loss = 3.3204e-02, PNorm = 55.0664, GNorm = 0.0564, lr_0 = 3.8251e-04
Loss = 3.6650e-02, PNorm = 55.1093, GNorm = 0.0581, lr_0 = 3.7352e-04
Loss = 3.0010e-02, PNorm = 55.1344, GNorm = 0.1021, lr_0 = 3.6474e-04
Loss = 3.1859e-02, PNorm = 55.1578, GNorm = 0.0508, lr_0 = 3.5617e-04
Loss = 2.7557e-02, PNorm = 55.1783, GNorm = 0.0758, lr_0 = 3.4779e-04
Loss = 2.9365e-02, PNorm = 55.1872, GNorm = 0.0697, lr_0 = 3.3962e-04
Loss = 2.6363e-02, PNorm = 55.2070, GNorm = 0.0475, lr_0 = 3.3164e-04
Loss = 3.6137e-02, PNorm = 55.2277, GNorm = 0.0905, lr_0 = 3.2384e-04
Loss = 2.8085e-02, PNorm = 55.2595, GNorm = 0.1045, lr_0 = 3.1623e-04
Validation auc = 0.876178
Epoch 6
Loss = 3.3340e-02, PNorm = 55.2717, GNorm = 0.0708, lr_0 = 3.0879e-04
Loss = 3.3191e-02, PNorm = 55.2906, GNorm = 0.1027, lr_0 = 3.0154e-04
Loss = 2.8892e-02, PNorm = 55.3211, GNorm = 0.0683, lr_0 = 2.9445e-04
Loss = 2.9696e-02, PNorm = 55.3430, GNorm = 0.0546, lr_0 = 2.8753e-04
Loss = 3.4588e-02, PNorm = 55.3525, GNorm = 0.0899, lr_0 = 2.8077e-04
Loss = 3.9354e-02, PNorm = 55.3747, GNorm = 0.0572, lr_0 = 2.7417e-04
Loss = 2.3859e-02, PNorm = 55.3953, GNorm = 0.0801, lr_0 = 2.6772e-04
Loss = 2.4233e-02, PNorm = 55.4157, GNorm = 0.0727, lr_0 = 2.6143e-04
Loss = 3.3833e-02, PNorm = 55.4236, GNorm = 0.0807, lr_0 = 2.5528e-04
Loss = 4.0201e-02, PNorm = 55.4297, GNorm = 0.0872, lr_0 = 2.4928e-04
Loss = 2.7724e-02, PNorm = 55.4493, GNorm = 0.0738, lr_0 = 2.4342e-04
Loss = 3.0622e-02, PNorm = 55.4596, GNorm = 0.0996, lr_0 = 2.3770e-04
Validation auc = 0.878097
Epoch 7
Loss = 6.4010e-02, PNorm = 55.4694, GNorm = 0.1478, lr_0 = 2.3156e-04
Loss = 2.6065e-02, PNorm = 55.4833, GNorm = 0.0801, lr_0 = 2.2612e-04
Loss = 2.6371e-02, PNorm = 55.4930, GNorm = 0.0668, lr_0 = 2.2080e-04
Loss = 3.3679e-02, PNorm = 55.5018, GNorm = 0.0754, lr_0 = 2.1561e-04
Loss = 2.4983e-02, PNorm = 55.5118, GNorm = 0.1002, lr_0 = 2.1055e-04
Loss = 3.3248e-02, PNorm = 55.5215, GNorm = 0.1009, lr_0 = 2.0560e-04
Loss = 3.1982e-02, PNorm = 55.5377, GNorm = 0.1176, lr_0 = 2.0076e-04
Loss = 4.1073e-02, PNorm = 55.5509, GNorm = 0.1082, lr_0 = 1.9604e-04
Loss = 3.1778e-02, PNorm = 55.5641, GNorm = 0.0881, lr_0 = 1.9144e-04
Loss = 2.0571e-02, PNorm = 55.5772, GNorm = 0.1010, lr_0 = 1.8694e-04
Loss = 3.0700e-02, PNorm = 55.5821, GNorm = 0.1258, lr_0 = 1.8254e-04
Loss = 3.1492e-02, PNorm = 55.5895, GNorm = 0.0880, lr_0 = 1.7825e-04
Validation auc = 0.881316
Epoch 8
Loss = 1.9239e-02, PNorm = 55.6016, GNorm = 0.0902, lr_0 = 1.7365e-04
Loss = 3.0873e-02, PNorm = 55.6111, GNorm = 0.0561, lr_0 = 1.6957e-04
Loss = 2.8110e-02, PNorm = 55.6197, GNorm = 0.0533, lr_0 = 1.6558e-04
Loss = 3.0648e-02, PNorm = 55.6245, GNorm = 0.0425, lr_0 = 1.6169e-04
Loss = 2.3329e-02, PNorm = 55.6311, GNorm = 0.0332, lr_0 = 1.5789e-04
Loss = 3.1752e-02, PNorm = 55.6339, GNorm = 0.1687, lr_0 = 1.5418e-04
Loss = 2.9812e-02, PNorm = 55.6379, GNorm = 0.0538, lr_0 = 1.5055e-04
Loss = 3.0785e-02, PNorm = 55.6447, GNorm = 0.0970, lr_0 = 1.4701e-04
Loss = 2.8225e-02, PNorm = 55.6567, GNorm = 0.0238, lr_0 = 1.4356e-04
Loss = 2.7489e-02, PNorm = 55.6656, GNorm = 0.1634, lr_0 = 1.4018e-04
Loss = 2.9279e-02, PNorm = 55.6723, GNorm = 0.0827, lr_0 = 1.3689e-04
Loss = 2.5119e-02, PNorm = 55.6824, GNorm = 0.0715, lr_0 = 1.3367e-04
Loss = 2.6786e-02, PNorm = 55.6887, GNorm = 0.0640, lr_0 = 1.3053e-04
Loss = 2.8179e-02, PNorm = 55.6896, GNorm = 0.1668, lr_0 = 1.3022e-04
Validation auc = 0.900593
Epoch 9
Loss = 3.0848e-02, PNorm = 55.7002, GNorm = 0.1308, lr_0 = 1.2716e-04
Loss = 2.3428e-02, PNorm = 55.7068, GNorm = 0.0816, lr_0 = 1.2417e-04
Loss = 3.2544e-02, PNorm = 55.7136, GNorm = 0.0666, lr_0 = 1.2125e-04
Loss = 3.4314e-02, PNorm = 55.7211, GNorm = 0.0589, lr_0 = 1.1840e-04
Loss = 2.3683e-02, PNorm = 55.7281, GNorm = 0.0881, lr_0 = 1.1562e-04
Loss = 3.1969e-02, PNorm = 55.7325, GNorm = 0.0913, lr_0 = 1.1290e-04
Loss = 2.8197e-02, PNorm = 55.7370, GNorm = 0.1600, lr_0 = 1.1024e-04
Loss = 3.1071e-02, PNorm = 55.7441, GNorm = 0.0893, lr_0 = 1.0765e-04
Loss = 2.7846e-02, PNorm = 55.7502, GNorm = 0.0781, lr_0 = 1.0512e-04
Loss = 2.8031e-02, PNorm = 55.7550, GNorm = 0.0692, lr_0 = 1.0265e-04
Loss = 2.4365e-02, PNorm = 55.7613, GNorm = 0.0552, lr_0 = 1.0024e-04
Loss = 3.2784e-02, PNorm = 55.7640, GNorm = 0.0682, lr_0 = 1.0000e-04
Validation auc = 0.903263
Model 0 best validation auc = 0.903263 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test auc = 0.835735
Ensemble test auc = 0.835735
1-fold cross validation
	Seed 42 ==> test auc = 0.835735
Overall test auc = 0.835735 +/- 0.000000
Elapsed time = 0:01:18
Command line
python main_script.py train all_amine_split_for_paper --epochs 10
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 9,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [0.05, 0.05, 0.05, 0.05, 0.95, 0.95, 0.95, 0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/test_extra_x.csv'],
 'separate_test_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/valid_extra_x.csv'],
 'separate_val_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['Biodistribution_heart',
                    'Biodistribution_kidney',
                    'Biodistribution_liver',
                    'Biodistribution_lung',
                    'Biodistribution_lymph_nodes',
                    'Biodistribution_muscle',
                    'Biodistribution_spleen',
                    'quantified_delivery',
                    'quantified_total_luminescence'],
 'target_weights': None,
 'task_names': ['Biodistribution_heart',
                'Biodistribution_kidney',
                'Biodistribution_liver',
                'Biodistribution_lung',
                'Biodistribution_lymph_nodes',
                'Biodistribution_muscle',
                'Biodistribution_spleen',
                'quantified_delivery',
                'quantified_total_luminescence'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 9
Fold 0
Splitting data with seed 42
Total size = 6,115 | train size = 6,115 | val size = 1,587 | test size = 2,240
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=621, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=9, bias=True)
  )
)
Number of parameters = 1,628,409
Moving model to cuda
Epoch 0
Loss = 1.1260e+00, PNorm = 52.2053, GNorm = 2.8409, lr_0 = 1.4057e-04
Loss = 8.7995e-01, PNorm = 52.2068, GNorm = 1.7179, lr_0 = 1.7746e-04
Loss = 9.1710e-01, PNorm = 52.2090, GNorm = 1.5421, lr_0 = 2.1434e-04
Loss = 1.0117e+00, PNorm = 52.2131, GNorm = 2.1242, lr_0 = 2.5123e-04
Loss = 1.1738e+00, PNorm = 52.2213, GNorm = 1.8412, lr_0 = 2.8811e-04
Loss = 9.9937e-01, PNorm = 52.2309, GNorm = 2.0783, lr_0 = 3.2500e-04
Loss = 9.4446e-01, PNorm = 52.2402, GNorm = 1.9060, lr_0 = 3.6189e-04
Loss = 8.0162e-01, PNorm = 52.2514, GNorm = 1.5810, lr_0 = 3.9877e-04
Loss = 8.7947e-01, PNorm = 52.2635, GNorm = 1.4201, lr_0 = 4.3566e-04
Loss = 9.5999e-01, PNorm = 52.2789, GNorm = 1.2883, lr_0 = 4.7254e-04
Loss = 9.7336e-01, PNorm = 52.2914, GNorm = 1.5387, lr_0 = 5.0943e-04
Loss = 9.1378e-01, PNorm = 52.3084, GNorm = 1.7816, lr_0 = 5.4631e-04
Validation rmse = 0.207543
Epoch 1
Loss = 9.1509e-01, PNorm = 52.3339, GNorm = 1.6921, lr_0 = 5.8689e-04
Loss = 8.9095e-01, PNorm = 52.3638, GNorm = 2.1755, lr_0 = 6.2377e-04
Loss = 8.0281e-01, PNorm = 52.3840, GNorm = 1.2066, lr_0 = 6.6066e-04
Loss = 1.1362e+00, PNorm = 52.4110, GNorm = 1.4825, lr_0 = 6.9754e-04
Loss = 9.2571e-01, PNorm = 52.4436, GNorm = 1.2938, lr_0 = 7.3443e-04
Loss = 9.3382e-01, PNorm = 52.4726, GNorm = 1.2174, lr_0 = 7.7131e-04
Loss = 9.2311e-01, PNorm = 52.5006, GNorm = 2.3313, lr_0 = 8.0820e-04
Loss = 9.7091e-01, PNorm = 52.5383, GNorm = 1.0943, lr_0 = 8.4508e-04
Loss = 9.0463e-01, PNorm = 52.5775, GNorm = 1.5523, lr_0 = 8.8197e-04
Loss = 9.2829e-01, PNorm = 52.6175, GNorm = 1.2483, lr_0 = 9.1885e-04
Loss = 8.4958e-01, PNorm = 52.6540, GNorm = 1.4916, lr_0 = 9.5574e-04
Loss = 6.8155e-01, PNorm = 52.6997, GNorm = 1.0489, lr_0 = 9.9262e-04
Validation rmse = 0.216740
Epoch 2
Loss = 8.1969e-01, PNorm = 52.7386, GNorm = 0.7868, lr_0 = 9.7899e-04
Loss = 9.7706e-01, PNorm = 52.7843, GNorm = 1.0016, lr_0 = 9.5616e-04
Loss = 9.0011e-01, PNorm = 52.8278, GNorm = 1.1358, lr_0 = 9.3387e-04
Loss = 7.6169e-01, PNorm = 52.8576, GNorm = 1.1657, lr_0 = 9.1210e-04
Loss = 9.8798e-01, PNorm = 52.8992, GNorm = 0.8862, lr_0 = 8.9083e-04
Loss = 7.9328e-01, PNorm = 52.9400, GNorm = 1.2224, lr_0 = 8.7006e-04
Loss = 8.6966e-01, PNorm = 52.9764, GNorm = 1.4992, lr_0 = 8.4977e-04
Loss = 7.9736e-01, PNorm = 53.0108, GNorm = 0.6612, lr_0 = 8.2996e-04
Loss = 9.8971e-01, PNorm = 53.0431, GNorm = 0.9316, lr_0 = 8.1061e-04
Loss = 8.2691e-01, PNorm = 53.0745, GNorm = 0.7898, lr_0 = 7.9171e-04
Loss = 9.3176e-01, PNorm = 53.0976, GNorm = 1.0437, lr_0 = 7.7325e-04
Loss = 8.4658e-01, PNorm = 53.1237, GNorm = 0.9725, lr_0 = 7.5522e-04
Validation rmse = 0.203805
Epoch 3
Loss = 6.6882e-01, PNorm = 53.1562, GNorm = 0.8157, lr_0 = 7.3587e-04
Loss = 8.5725e-01, PNorm = 53.1816, GNorm = 0.7712, lr_0 = 7.1872e-04
Loss = 9.7240e-01, PNorm = 53.2130, GNorm = 1.3314, lr_0 = 7.0196e-04
Loss = 7.9933e-01, PNorm = 53.2430, GNorm = 1.1499, lr_0 = 6.8559e-04
Loss = 7.6467e-01, PNorm = 53.2677, GNorm = 0.7587, lr_0 = 6.6961e-04
Loss = 8.4818e-01, PNorm = 53.2928, GNorm = 1.0191, lr_0 = 6.5399e-04
Loss = 9.0685e-01, PNorm = 53.3228, GNorm = 1.1059, lr_0 = 6.3875e-04
Loss = 8.3583e-01, PNorm = 53.3533, GNorm = 1.5128, lr_0 = 6.2385e-04
Loss = 7.2816e-01, PNorm = 53.3962, GNorm = 0.6941, lr_0 = 6.0931e-04
Loss = 9.8201e-01, PNorm = 53.4336, GNorm = 0.8905, lr_0 = 5.9510e-04
Loss = 8.9970e-01, PNorm = 53.4692, GNorm = 0.9604, lr_0 = 5.8122e-04
Loss = 8.6514e-01, PNorm = 53.4986, GNorm = 1.0712, lr_0 = 5.6767e-04
Validation rmse = 0.198430
Epoch 4
Loss = 9.6267e-01, PNorm = 53.5257, GNorm = 0.8021, lr_0 = 5.5444e-04
Loss = 8.3567e-01, PNorm = 53.5579, GNorm = 0.8524, lr_0 = 5.4151e-04
Loss = 6.6059e-01, PNorm = 53.5887, GNorm = 0.7457, lr_0 = 5.2888e-04
Loss = 7.5628e-01, PNorm = 53.6135, GNorm = 0.9998, lr_0 = 5.1655e-04
Loss = 9.0148e-01, PNorm = 53.6406, GNorm = 0.9254, lr_0 = 5.0451e-04
Loss = 1.0879e+00, PNorm = 53.6781, GNorm = 1.3933, lr_0 = 4.9275e-04
Loss = 7.7909e-01, PNorm = 53.7146, GNorm = 0.9217, lr_0 = 4.8126e-04
Loss = 7.8830e-01, PNorm = 53.7496, GNorm = 0.9945, lr_0 = 4.7004e-04
Loss = 7.8670e-01, PNorm = 53.7758, GNorm = 1.1220, lr_0 = 4.5908e-04
Loss = 7.5296e-01, PNorm = 53.8147, GNorm = 1.2051, lr_0 = 4.4837e-04
Loss = 8.5988e-01, PNorm = 53.8637, GNorm = 1.4010, lr_0 = 4.3792e-04
Loss = 7.2065e-01, PNorm = 53.9022, GNorm = 1.1828, lr_0 = 4.2771e-04
Loss = 8.8808e-01, PNorm = 53.9379, GNorm = 0.8889, lr_0 = 4.1774e-04
Validation rmse = 0.199707
Epoch 5
Loss = 7.4504e-01, PNorm = 53.9733, GNorm = 1.5016, lr_0 = 4.0703e-04
Loss = 7.8714e-01, PNorm = 54.0126, GNorm = 0.7487, lr_0 = 3.9754e-04
Loss = 8.5754e-01, PNorm = 54.0427, GNorm = 1.1802, lr_0 = 3.8827e-04
Loss = 6.7941e-01, PNorm = 54.0691, GNorm = 1.1903, lr_0 = 3.7922e-04
Loss = 8.5871e-01, PNorm = 54.1018, GNorm = 1.4507, lr_0 = 3.7038e-04
Loss = 7.4828e-01, PNorm = 54.1311, GNorm = 1.3228, lr_0 = 3.6174e-04
Loss = 8.4348e-01, PNorm = 54.1676, GNorm = 0.7815, lr_0 = 3.5331e-04
Loss = 8.4790e-01, PNorm = 54.1995, GNorm = 0.7314, lr_0 = 3.4507e-04
Loss = 8.0514e-01, PNorm = 54.2266, GNorm = 1.1146, lr_0 = 3.3703e-04
Loss = 7.3512e-01, PNorm = 54.2526, GNorm = 1.1287, lr_0 = 3.2917e-04
Loss = 7.9321e-01, PNorm = 54.2725, GNorm = 1.1984, lr_0 = 3.2149e-04
Loss = 7.7059e-01, PNorm = 54.2949, GNorm = 1.3695, lr_0 = 3.1400e-04
Validation rmse = 0.199575
Epoch 6
Loss = 6.2930e-01, PNorm = 54.3160, GNorm = 0.7634, lr_0 = 3.0595e-04
Loss = 7.1574e-01, PNorm = 54.3303, GNorm = 0.5209, lr_0 = 2.9882e-04
Loss = 7.4591e-01, PNorm = 54.3486, GNorm = 1.6152, lr_0 = 2.9185e-04
Loss = 8.5514e-01, PNorm = 54.3646, GNorm = 1.2145, lr_0 = 2.8505e-04
Loss = 9.0384e-01, PNorm = 54.3845, GNorm = 1.1838, lr_0 = 2.7840e-04
Loss = 8.3690e-01, PNorm = 54.4071, GNorm = 1.8198, lr_0 = 2.7191e-04
Loss = 8.1271e-01, PNorm = 54.4285, GNorm = 1.5767, lr_0 = 2.6557e-04
Loss = 7.1879e-01, PNorm = 54.4584, GNorm = 1.5415, lr_0 = 2.5938e-04
Loss = 7.3317e-01, PNorm = 54.4806, GNorm = 0.8900, lr_0 = 2.5333e-04
Loss = 7.3171e-01, PNorm = 54.5037, GNorm = 0.9523, lr_0 = 2.4742e-04
Loss = 7.8840e-01, PNorm = 54.5193, GNorm = 0.9517, lr_0 = 2.4166e-04
Loss = 7.1969e-01, PNorm = 54.5335, GNorm = 1.8848, lr_0 = 2.3602e-04
Validation rmse = 0.199121
Epoch 7
Loss = 6.9075e-01, PNorm = 54.5495, GNorm = 0.9199, lr_0 = 2.3052e-04
Loss = 7.3464e-01, PNorm = 54.5650, GNorm = 0.9317, lr_0 = 2.2514e-04
Loss = 7.5492e-01, PNorm = 54.5778, GNorm = 0.9781, lr_0 = 2.1989e-04
Loss = 8.6813e-01, PNorm = 54.5909, GNorm = 1.3280, lr_0 = 2.1477e-04
Loss = 7.5007e-01, PNorm = 54.6015, GNorm = 0.9851, lr_0 = 2.0976e-04
Loss = 6.7303e-01, PNorm = 54.6187, GNorm = 1.1702, lr_0 = 2.0487e-04
Loss = 7.5328e-01, PNorm = 54.6348, GNorm = 1.1467, lr_0 = 2.0009e-04
Loss = 7.3194e-01, PNorm = 54.6552, GNorm = 0.9180, lr_0 = 1.9543e-04
Loss = 6.1768e-01, PNorm = 54.6703, GNorm = 1.1550, lr_0 = 1.9087e-04
Loss = 7.1139e-01, PNorm = 54.6783, GNorm = 1.3766, lr_0 = 1.8642e-04
Loss = 7.8435e-01, PNorm = 54.6926, GNorm = 1.2548, lr_0 = 1.8207e-04
Loss = 6.0538e-01, PNorm = 54.7075, GNorm = 1.1692, lr_0 = 1.7783e-04
Validation rmse = 0.198872
Epoch 8
Loss = 8.2685e-01, PNorm = 54.7228, GNorm = 1.1565, lr_0 = 1.7327e-04
Loss = 8.0058e-01, PNorm = 54.7336, GNorm = 1.5272, lr_0 = 1.6923e-04
Loss = 6.7034e-01, PNorm = 54.7402, GNorm = 1.5031, lr_0 = 1.6529e-04
Loss = 7.2887e-01, PNorm = 54.7489, GNorm = 0.9821, lr_0 = 1.6143e-04
Loss = 7.8373e-01, PNorm = 54.7600, GNorm = 1.4546, lr_0 = 1.5767e-04
Loss = 6.1918e-01, PNorm = 54.7722, GNorm = 1.1970, lr_0 = 1.5399e-04
Loss = 6.8786e-01, PNorm = 54.7793, GNorm = 0.8760, lr_0 = 1.5040e-04
Loss = 6.8615e-01, PNorm = 54.7921, GNorm = 0.9223, lr_0 = 1.4690e-04
Loss = 7.0560e-01, PNorm = 54.8030, GNorm = 1.1634, lr_0 = 1.4347e-04
Loss = 7.5481e-01, PNorm = 54.8141, GNorm = 1.3681, lr_0 = 1.4013e-04
Loss = 7.5365e-01, PNorm = 54.8264, GNorm = 1.1007, lr_0 = 1.3686e-04
Loss = 6.6314e-01, PNorm = 54.8361, GNorm = 1.1305, lr_0 = 1.3367e-04
Loss = 7.0975e-01, PNorm = 54.8475, GNorm = 1.6282, lr_0 = 1.3055e-04
Loss = 1.2727e+00, PNorm = 54.8486, GNorm = 2.6273, lr_0 = 1.3024e-04
Validation rmse = 0.200646
Epoch 9
Loss = 7.4822e-01, PNorm = 54.8562, GNorm = 1.9158, lr_0 = 1.2721e-04
Loss = 7.0753e-01, PNorm = 54.8636, GNorm = 1.0562, lr_0 = 1.2424e-04
Loss = 6.5798e-01, PNorm = 54.8697, GNorm = 1.0903, lr_0 = 1.2134e-04
Loss = 6.6096e-01, PNorm = 54.8785, GNorm = 1.1302, lr_0 = 1.1851e-04
Loss = 9.3664e-01, PNorm = 54.8874, GNorm = 1.1973, lr_0 = 1.1575e-04
Loss = 7.0059e-01, PNorm = 54.8961, GNorm = 2.0304, lr_0 = 1.1305e-04
Loss = 6.6630e-01, PNorm = 54.9016, GNorm = 0.7836, lr_0 = 1.1042e-04
Loss = 6.3933e-01, PNorm = 54.9066, GNorm = 1.0556, lr_0 = 1.0784e-04
Loss = 6.4967e-01, PNorm = 54.9121, GNorm = 0.9015, lr_0 = 1.0533e-04
Loss = 7.7820e-01, PNorm = 54.9197, GNorm = 0.9802, lr_0 = 1.0287e-04
Loss = 6.1924e-01, PNorm = 54.9258, GNorm = 1.1544, lr_0 = 1.0047e-04
Loss = 7.8121e-01, PNorm = 54.9298, GNorm = 1.2912, lr_0 = 1.0000e-04
Validation rmse = 0.198287
Model 0 best validation rmse = 0.198287 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.288864
Ensemble test rmse = 0.173079
1-fold cross validation
	Seed 42 ==> test rmse = 0.173079
Overall test rmse = 0.173079 +/- 0.000000
Elapsed time = 0:01:11
Command line
python main_script.py train all_amine_split_for_paper --epochs 10
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/train_clf.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 15,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1_clf',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/test_extra_x.csv'],
 'separate_test_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/test_clf.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/valid_extra_x.csv'],
 'separate_val_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_1/valid_clf.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['Encapsulation_Efficiency_EE<50',
                    'Encapsulation_Efficiency_50<=EE<80',
                    'Encapsulation_Efficiency_80<EE<=100',
                    'Delivery_target_lymph_nodes',
                    'chronic_toxicity_none',
                    'acute_toxicity_none',
                    'acute_toxicity_present',
                    'Delivery_target_dendritic_cell',
                    'Delivery_target_generic_cell',
                    'Delivery_target_macrophage',
                    'Delivery_target_lung_epithelium',
                    'Delivery_target_liver',
                    'Delivery_target_lung',
                    'Delivery_target_spleen',
                    'Delivery_target_muscle'],
 'target_weights': None,
 'task_names': ['Encapsulation_Efficiency_EE<50',
                'Encapsulation_Efficiency_50<=EE<80',
                'Encapsulation_Efficiency_80<EE<=100',
                'Delivery_target_lymph_nodes',
                'chronic_toxicity_none',
                'acute_toxicity_none',
                'acute_toxicity_present',
                'Delivery_target_dendritic_cell',
                'Delivery_target_generic_cell',
                'Delivery_target_macrophage',
                'Delivery_target_lung_epithelium',
                'Delivery_target_liver',
                'Delivery_target_lung',
                'Delivery_target_spleen',
                'Delivery_target_muscle'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 15
Fold 0
Splitting data with seed 42
Class sizes
Encapsulation_Efficiency_EE<50 0: 86.05%, 1: 13.95%
Encapsulation_Efficiency_50<=EE<80 0: 70.16%, 1: 29.84%
Encapsulation_Efficiency_80<EE<=100 0: 43.80%, 1: 56.20%
Delivery_target_lymph_nodes 0: 96.41%, 1: 3.59%
chronic_toxicity_none 0: 90.70%, 1: 9.30%
acute_toxicity_none 0: 25.19%, 1: 74.81%
acute_toxicity_present 0: 95.74%, 1: 4.26%
Delivery_target_dendritic_cell 0: 99.89%, 1: 0.11%
Delivery_target_generic_cell 0: 30.55%, 1: 69.45%
Delivery_target_macrophage 0: 99.66%, 1: 0.34%
Delivery_target_lung_epithelium 0: 82.80%, 1: 17.20%
Delivery_target_liver 0: 93.12%, 1: 6.88%
Delivery_target_lung 0: 99.39%, 1: 0.61%
Delivery_target_spleen 0: 98.43%, 1: 1.57%
Delivery_target_muscle 0: 96.80%, 1: 3.20%
Total size = 6,196 | train size = 6,196 | val size = 1,587 | test size = 2,240
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=621, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=15, bias=True)
  )
)
Number of parameters = 1,632,015
Moving model to cuda
Epoch 0
Loss = 5.5216e-01, PNorm = 52.3243, GNorm = 0.9712, lr_0 = 1.4024e-04
Loss = 2.5548e-01, PNorm = 52.3536, GNorm = 0.5009, lr_0 = 1.7683e-04
Loss = 1.8770e-01, PNorm = 52.3645, GNorm = 0.6599, lr_0 = 2.1341e-04
Loss = 1.5881e-01, PNorm = 52.3743, GNorm = 0.3823, lr_0 = 2.5000e-04
Loss = 1.3548e-01, PNorm = 52.3893, GNorm = 0.3756, lr_0 = 2.8659e-04
Loss = 9.1360e-02, PNorm = 52.4091, GNorm = 0.1378, lr_0 = 3.2317e-04
Loss = 8.8303e-02, PNorm = 52.4315, GNorm = 0.2084, lr_0 = 3.5976e-04
Loss = 8.0193e-02, PNorm = 52.4585, GNorm = 0.1602, lr_0 = 3.9634e-04
Loss = 4.9024e-02, PNorm = 52.4879, GNorm = 0.2694, lr_0 = 4.3293e-04
Loss = 4.5735e-02, PNorm = 52.5193, GNorm = 0.1857, lr_0 = 4.6951e-04
Loss = 7.5768e-02, PNorm = 52.5473, GNorm = 0.3309, lr_0 = 5.0610e-04
Loss = 6.7446e-02, PNorm = 52.5763, GNorm = 0.1849, lr_0 = 5.4268e-04
Validation auc = 0.794886
Epoch 1
Loss = 6.2114e-02, PNorm = 52.6163, GNorm = 0.1563, lr_0 = 5.8293e-04
Loss = 4.7004e-02, PNorm = 52.6565, GNorm = 0.1187, lr_0 = 6.1951e-04
Loss = 3.9643e-02, PNorm = 52.6913, GNorm = 0.1254, lr_0 = 6.5610e-04
Loss = 5.2840e-02, PNorm = 52.7274, GNorm = 0.1893, lr_0 = 6.9268e-04
Loss = 6.4172e-02, PNorm = 52.7688, GNorm = 0.1961, lr_0 = 7.2927e-04
Loss = 4.3144e-02, PNorm = 52.8176, GNorm = 0.1869, lr_0 = 7.6585e-04
Loss = 4.7305e-02, PNorm = 52.8624, GNorm = 0.1418, lr_0 = 8.0244e-04
Loss = 3.9838e-02, PNorm = 52.9204, GNorm = 0.1492, lr_0 = 8.3902e-04
Loss = 2.7195e-02, PNorm = 52.9721, GNorm = 0.0714, lr_0 = 8.7561e-04
Loss = 4.5508e-02, PNorm = 53.0345, GNorm = 0.0867, lr_0 = 9.1220e-04
Loss = 4.1695e-02, PNorm = 53.0751, GNorm = 0.1128, lr_0 = 9.4878e-04
Loss = 4.2645e-02, PNorm = 53.1295, GNorm = 0.1880, lr_0 = 9.8537e-04
Validation auc = 0.842954
Epoch 2
Loss = 3.8724e-02, PNorm = 53.1873, GNorm = 0.0895, lr_0 = 9.8606e-04
Loss = 4.4894e-02, PNorm = 53.2314, GNorm = 0.1551, lr_0 = 9.6325e-04
Loss = 5.0136e-02, PNorm = 53.3181, GNorm = 0.1526, lr_0 = 9.4097e-04
Loss = 3.5456e-02, PNorm = 53.3872, GNorm = 0.0498, lr_0 = 9.1921e-04
Loss = 3.1557e-02, PNorm = 53.4497, GNorm = 0.0469, lr_0 = 8.9795e-04
Loss = 4.8874e-02, PNorm = 53.5030, GNorm = 0.1546, lr_0 = 8.7718e-04
Loss = 3.8210e-02, PNorm = 53.5720, GNorm = 0.0495, lr_0 = 8.5689e-04
Loss = 4.1428e-02, PNorm = 53.6128, GNorm = 0.1183, lr_0 = 8.3707e-04
Loss = 5.1021e-02, PNorm = 53.6677, GNorm = 0.1108, lr_0 = 8.1771e-04
Loss = 3.4706e-02, PNorm = 53.7361, GNorm = 0.0665, lr_0 = 7.9880e-04
Loss = 4.0059e-02, PNorm = 53.7650, GNorm = 0.0673, lr_0 = 7.8033e-04
Loss = 4.1773e-02, PNorm = 53.8312, GNorm = 0.0923, lr_0 = 7.6228e-04
Loss = 3.0122e-02, PNorm = 53.9006, GNorm = 0.0477, lr_0 = 7.4465e-04
Validation auc = 0.851013
Epoch 3
Loss = 4.1442e-02, PNorm = 53.9383, GNorm = 0.0999, lr_0 = 7.2743e-04
Loss = 3.3735e-02, PNorm = 53.9861, GNorm = 0.0604, lr_0 = 7.1060e-04
Loss = 3.1659e-02, PNorm = 54.0222, GNorm = 0.1130, lr_0 = 6.9417e-04
Loss = 2.5121e-02, PNorm = 54.0630, GNorm = 0.0552, lr_0 = 6.7811e-04
Loss = 4.6207e-02, PNorm = 54.0884, GNorm = 0.1355, lr_0 = 6.6243e-04
Loss = 2.7772e-02, PNorm = 54.1281, GNorm = 0.0595, lr_0 = 6.4711e-04
Loss = 4.1358e-02, PNorm = 54.1572, GNorm = 0.0922, lr_0 = 6.3214e-04
Loss = 2.6395e-02, PNorm = 54.2125, GNorm = 0.0717, lr_0 = 6.1752e-04
Loss = 4.3691e-02, PNorm = 54.2346, GNorm = 0.1162, lr_0 = 6.0324e-04
Loss = 4.9451e-02, PNorm = 54.2627, GNorm = 0.0872, lr_0 = 5.8928e-04
Loss = 3.0266e-02, PNorm = 54.3253, GNorm = 0.0783, lr_0 = 5.7566e-04
Loss = 3.9875e-02, PNorm = 54.3456, GNorm = 0.0857, lr_0 = 5.6234e-04
Validation auc = 0.842831
Epoch 4
Loss = 3.5926e-02, PNorm = 54.3821, GNorm = 0.0918, lr_0 = 5.4934e-04
Loss = 3.8293e-02, PNorm = 54.4089, GNorm = 0.0856, lr_0 = 5.3663e-04
Loss = 4.6613e-02, PNorm = 54.4323, GNorm = 0.1397, lr_0 = 5.2422e-04
Loss = 3.5022e-02, PNorm = 54.4772, GNorm = 0.0769, lr_0 = 5.1209e-04
Loss = 3.2000e-02, PNorm = 54.4939, GNorm = 0.0713, lr_0 = 5.0025e-04
Loss = 4.0264e-02, PNorm = 54.5114, GNorm = 0.1414, lr_0 = 4.8868e-04
Loss = 3.1599e-02, PNorm = 54.5615, GNorm = 0.1246, lr_0 = 4.7738e-04
Loss = 4.0320e-02, PNorm = 54.5766, GNorm = 0.1278, lr_0 = 4.6634e-04
Loss = 2.4238e-02, PNorm = 54.6439, GNorm = 0.0603, lr_0 = 4.5555e-04
Loss = 3.2606e-02, PNorm = 54.6635, GNorm = 0.0823, lr_0 = 4.4501e-04
Loss = 3.4897e-02, PNorm = 54.6926, GNorm = 0.0452, lr_0 = 4.3472e-04
Loss = 3.4259e-02, PNorm = 54.7287, GNorm = 0.0507, lr_0 = 4.2467e-04
Validation auc = 0.827605
Epoch 5
Loss = 2.3801e-02, PNorm = 54.7671, GNorm = 0.0889, lr_0 = 4.1485e-04
Loss = 3.5310e-02, PNorm = 54.8078, GNorm = 0.1327, lr_0 = 4.0525e-04
Loss = 3.1544e-02, PNorm = 54.8329, GNorm = 0.1170, lr_0 = 3.9588e-04
Loss = 2.4646e-02, PNorm = 54.8704, GNorm = 0.0729, lr_0 = 3.8672e-04
Loss = 3.7194e-02, PNorm = 54.8773, GNorm = 0.0728, lr_0 = 3.7778e-04
Loss = 2.6603e-02, PNorm = 54.8989, GNorm = 0.0767, lr_0 = 3.6904e-04
Loss = 4.6412e-02, PNorm = 54.9348, GNorm = 0.1712, lr_0 = 3.6050e-04
Loss = 3.7931e-02, PNorm = 54.9613, GNorm = 0.1949, lr_0 = 3.5217e-04
Loss = 2.4259e-02, PNorm = 54.9828, GNorm = 0.0942, lr_0 = 3.4402e-04
Loss = 3.2430e-02, PNorm = 54.9957, GNorm = 0.1058, lr_0 = 3.3606e-04
Loss = 2.9355e-02, PNorm = 55.0171, GNorm = 0.0414, lr_0 = 3.2829e-04
Loss = 3.6879e-02, PNorm = 55.0288, GNorm = 0.0688, lr_0 = 3.2070e-04
Loss = 3.4417e-02, PNorm = 55.0471, GNorm = 0.0480, lr_0 = 3.1328e-04
Validation auc = 0.850250
Epoch 6
Loss = 3.9558e-02, PNorm = 55.0627, GNorm = 0.1000, lr_0 = 3.0604e-04
Loss = 2.8230e-02, PNorm = 55.1013, GNorm = 0.0181, lr_0 = 2.9896e-04
Loss = 3.0910e-02, PNorm = 55.1204, GNorm = 0.1466, lr_0 = 2.9204e-04
Loss = 2.7825e-02, PNorm = 55.1347, GNorm = 0.0408, lr_0 = 2.8529e-04
Loss = 2.5860e-02, PNorm = 55.1444, GNorm = 0.0959, lr_0 = 2.7869e-04
Loss = 3.4696e-02, PNorm = 55.1487, GNorm = 0.0601, lr_0 = 2.7224e-04
Loss = 3.7949e-02, PNorm = 55.1663, GNorm = 0.0846, lr_0 = 2.6595e-04
Loss = 2.3151e-02, PNorm = 55.1873, GNorm = 0.0681, lr_0 = 2.5980e-04
Loss = 2.6401e-02, PNorm = 55.1991, GNorm = 0.0633, lr_0 = 2.5379e-04
Loss = 3.7663e-02, PNorm = 55.2090, GNorm = 0.0902, lr_0 = 2.4792e-04
Loss = 3.3912e-02, PNorm = 55.2222, GNorm = 0.0704, lr_0 = 2.4218e-04
Loss = 3.3227e-02, PNorm = 55.2177, GNorm = 0.0520, lr_0 = 2.3658e-04
Validation auc = 0.835871
Epoch 7
Loss = 3.3380e-02, PNorm = 55.2419, GNorm = 0.1003, lr_0 = 2.3111e-04
Loss = 2.9961e-02, PNorm = 55.2681, GNorm = 0.0728, lr_0 = 2.2577e-04
Loss = 2.6546e-02, PNorm = 55.2852, GNorm = 0.0499, lr_0 = 2.2054e-04
Loss = 3.0703e-02, PNorm = 55.2971, GNorm = 0.0887, lr_0 = 2.1544e-04
Loss = 3.0490e-02, PNorm = 55.3065, GNorm = 0.0594, lr_0 = 2.1046e-04
Loss = 3.1782e-02, PNorm = 55.3139, GNorm = 0.1269, lr_0 = 2.0559e-04
Loss = 3.3574e-02, PNorm = 55.3188, GNorm = 0.0784, lr_0 = 2.0084e-04
Loss = 3.7666e-02, PNorm = 55.3349, GNorm = 0.0886, lr_0 = 1.9619e-04
Loss = 2.5998e-02, PNorm = 55.3556, GNorm = 0.0792, lr_0 = 1.9166e-04
Loss = 2.4171e-02, PNorm = 55.3650, GNorm = 0.0612, lr_0 = 1.8722e-04
Loss = 2.6484e-02, PNorm = 55.3745, GNorm = 0.0446, lr_0 = 1.8289e-04
Loss = 2.2476e-02, PNorm = 55.3900, GNorm = 0.1014, lr_0 = 1.7866e-04
Loss = 3.3375e-02, PNorm = 55.4028, GNorm = 0.1091, lr_0 = 1.7453e-04
Validation auc = 0.837215
Epoch 8
Loss = 2.3825e-02, PNorm = 55.4128, GNorm = 0.1017, lr_0 = 1.7049e-04
Loss = 2.0117e-02, PNorm = 55.4214, GNorm = 0.0608, lr_0 = 1.6655e-04
Loss = 2.9059e-02, PNorm = 55.4259, GNorm = 0.0889, lr_0 = 1.6270e-04
Loss = 3.1887e-02, PNorm = 55.4250, GNorm = 0.1071, lr_0 = 1.5893e-04
Loss = 3.4128e-02, PNorm = 55.4283, GNorm = 0.1166, lr_0 = 1.5526e-04
Loss = 2.7282e-02, PNorm = 55.4413, GNorm = 0.0672, lr_0 = 1.5167e-04
Loss = 2.9800e-02, PNorm = 55.4566, GNorm = 0.0363, lr_0 = 1.4816e-04
Loss = 2.9192e-02, PNorm = 55.4669, GNorm = 0.0559, lr_0 = 1.4473e-04
Loss = 2.7248e-02, PNorm = 55.4764, GNorm = 0.1164, lr_0 = 1.4139e-04
Loss = 2.9455e-02, PNorm = 55.4867, GNorm = 0.1067, lr_0 = 1.3812e-04
Loss = 2.3805e-02, PNorm = 55.4949, GNorm = 0.0553, lr_0 = 1.3492e-04
Loss = 2.0443e-02, PNorm = 55.5034, GNorm = 0.0649, lr_0 = 1.3180e-04
Validation auc = 0.858520
Epoch 9
Loss = 2.9194e-02, PNorm = 55.5057, GNorm = 0.1492, lr_0 = 1.2875e-04
Loss = 2.1145e-02, PNorm = 55.5081, GNorm = 0.1540, lr_0 = 1.2577e-04
Loss = 3.0625e-02, PNorm = 55.5146, GNorm = 0.1195, lr_0 = 1.2287e-04
Loss = 2.9380e-02, PNorm = 55.5243, GNorm = 0.0993, lr_0 = 1.2002e-04
Loss = 3.1750e-02, PNorm = 55.5318, GNorm = 0.0990, lr_0 = 1.1725e-04
Loss = 3.6601e-02, PNorm = 55.5345, GNorm = 0.0732, lr_0 = 1.1454e-04
Loss = 2.1371e-02, PNorm = 55.5366, GNorm = 0.0450, lr_0 = 1.1189e-04
Loss = 3.6373e-02, PNorm = 55.5380, GNorm = 0.0656, lr_0 = 1.0930e-04
Loss = 2.1149e-02, PNorm = 55.5438, GNorm = 0.1080, lr_0 = 1.0677e-04
Loss = 2.6965e-02, PNorm = 55.5509, GNorm = 0.0660, lr_0 = 1.0430e-04
Loss = 3.2138e-02, PNorm = 55.5576, GNorm = 0.1487, lr_0 = 1.0189e-04
Loss = 4.0969e-02, PNorm = 55.5620, GNorm = 0.0947, lr_0 = 1.0000e-04
Validation auc = 0.860318
Model 0 best validation auc = 0.860318 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test auc = 0.887579
Ensemble test auc = 0.887579
1-fold cross validation
	Seed 42 ==> test auc = 0.887579
Overall test auc = 0.887579 +/- 0.000000
Elapsed time = 0:01:12
Command line
python main_script.py train all_amine_split_for_paper --epochs 10
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 9,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [0.05, 0.05, 0.05, 0.05, 0.95, 0.95, 0.95, 0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/test_extra_x.csv'],
 'separate_test_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/valid_extra_x.csv'],
 'separate_val_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['Biodistribution_heart',
                    'Biodistribution_kidney',
                    'Biodistribution_liver',
                    'Biodistribution_lung',
                    'Biodistribution_lymph_nodes',
                    'Biodistribution_muscle',
                    'Biodistribution_spleen',
                    'quantified_delivery',
                    'quantified_total_luminescence'],
 'target_weights': None,
 'task_names': ['Biodistribution_heart',
                'Biodistribution_kidney',
                'Biodistribution_liver',
                'Biodistribution_lung',
                'Biodistribution_lymph_nodes',
                'Biodistribution_muscle',
                'Biodistribution_spleen',
                'quantified_delivery',
                'quantified_total_luminescence'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 9
Fold 0
Splitting data with seed 42
Total size = 6,539 | train size = 6,539 | val size = 1,812 | test size = 1,599
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=621, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=9, bias=True)
  )
)
Number of parameters = 1,628,409
Moving model to cuda
Epoch 0
Loss = 1.0613e+00, PNorm = 52.2044, GNorm = 2.4974, lr_0 = 1.3808e-04
Loss = 9.3871e-01, PNorm = 52.2064, GNorm = 3.1199, lr_0 = 1.7269e-04
Loss = 1.0849e+00, PNorm = 52.2100, GNorm = 2.0258, lr_0 = 2.0731e-04
Loss = 8.9291e-01, PNorm = 52.2164, GNorm = 1.8543, lr_0 = 2.4192e-04
Loss = 9.1474e-01, PNorm = 52.2246, GNorm = 4.5015, lr_0 = 2.7654e-04
Loss = 9.2292e-01, PNorm = 52.2319, GNorm = 1.5289, lr_0 = 3.1115e-04
Loss = 9.3222e-01, PNorm = 52.2403, GNorm = 3.6877, lr_0 = 3.4577e-04
Loss = 9.1001e-01, PNorm = 52.2491, GNorm = 2.6497, lr_0 = 3.8038e-04
Loss = 9.6088e-01, PNorm = 52.2584, GNorm = 1.4843, lr_0 = 4.1500e-04
Loss = 8.9864e-01, PNorm = 52.2739, GNorm = 1.0366, lr_0 = 4.4962e-04
Loss = 9.9502e-01, PNorm = 52.2881, GNorm = 1.6688, lr_0 = 4.8423e-04
Loss = 9.7628e-01, PNorm = 52.3061, GNorm = 2.1649, lr_0 = 5.1885e-04
Loss = 8.8157e-01, PNorm = 52.3270, GNorm = 1.5763, lr_0 = 5.5346e-04
Loss = 7.5984e-01, PNorm = 52.3290, GNorm = 1.8843, lr_0 = 5.5692e-04
Validation rmse = 0.187384
Epoch 1
Loss = 7.7082e-01, PNorm = 52.3539, GNorm = 1.5370, lr_0 = 5.9154e-04
Loss = 8.6205e-01, PNorm = 52.3753, GNorm = 2.0602, lr_0 = 6.2615e-04
Loss = 1.0544e+00, PNorm = 52.3989, GNorm = 1.6143, lr_0 = 6.6077e-04
Loss = 9.9478e-01, PNorm = 52.4274, GNorm = 1.3272, lr_0 = 6.9538e-04
Loss = 1.0679e+00, PNorm = 52.4575, GNorm = 1.5853, lr_0 = 7.3000e-04
Loss = 9.4271e-01, PNorm = 52.4965, GNorm = 1.6864, lr_0 = 7.6462e-04
Loss = 8.0098e-01, PNorm = 52.5248, GNorm = 1.9607, lr_0 = 7.9923e-04
Loss = 8.6244e-01, PNorm = 52.5586, GNorm = 1.6267, lr_0 = 8.3385e-04
Loss = 9.0319e-01, PNorm = 52.5933, GNorm = 1.8093, lr_0 = 8.6846e-04
Loss = 9.1262e-01, PNorm = 52.6333, GNorm = 1.0773, lr_0 = 9.0308e-04
Loss = 8.5174e-01, PNorm = 52.6707, GNorm = 1.4391, lr_0 = 9.3769e-04
Loss = 7.4597e-01, PNorm = 52.7102, GNorm = 0.8743, lr_0 = 9.7231e-04
Loss = 9.0828e-01, PNorm = 52.7572, GNorm = 2.2396, lr_0 = 9.9558e-04
Validation rmse = 0.181022
Epoch 2
Loss = 8.8201e-01, PNorm = 52.8084, GNorm = 1.3527, lr_0 = 9.7378e-04
Loss = 8.6960e-01, PNorm = 52.8490, GNorm = 1.0766, lr_0 = 9.5246e-04
Loss = 7.6159e-01, PNorm = 52.8994, GNorm = 0.9760, lr_0 = 9.3160e-04
Loss = 9.1518e-01, PNorm = 52.9359, GNorm = 1.3784, lr_0 = 9.1120e-04
Loss = 8.7565e-01, PNorm = 52.9763, GNorm = 1.4715, lr_0 = 8.9125e-04
Loss = 9.6697e-01, PNorm = 53.0145, GNorm = 1.3898, lr_0 = 8.7174e-04
Loss = 9.4783e-01, PNorm = 53.0535, GNorm = 1.5552, lr_0 = 8.5265e-04
Loss = 7.9408e-01, PNorm = 53.0941, GNorm = 0.6812, lr_0 = 8.3398e-04
Loss = 1.0348e+00, PNorm = 53.1237, GNorm = 0.8954, lr_0 = 8.1572e-04
Loss = 6.8708e-01, PNorm = 53.1647, GNorm = 0.9946, lr_0 = 7.9785e-04
Loss = 9.2144e-01, PNorm = 53.2102, GNorm = 1.2231, lr_0 = 7.8038e-04
Loss = 8.8450e-01, PNorm = 53.2459, GNorm = 0.8306, lr_0 = 7.6329e-04
Loss = 8.0004e-01, PNorm = 53.2878, GNorm = 0.8654, lr_0 = 7.4658e-04
Validation rmse = 0.188099
Epoch 3
Loss = 8.6981e-01, PNorm = 53.3200, GNorm = 1.1132, lr_0 = 7.3023e-04
Loss = 8.9651e-01, PNorm = 53.3581, GNorm = 1.0018, lr_0 = 7.1424e-04
Loss = 9.1365e-01, PNorm = 53.3921, GNorm = 1.1660, lr_0 = 6.9860e-04
Loss = 8.1844e-01, PNorm = 53.4279, GNorm = 1.3912, lr_0 = 6.8331e-04
Loss = 8.5934e-01, PNorm = 53.4707, GNorm = 0.8663, lr_0 = 6.6834e-04
Loss = 9.2242e-01, PNorm = 53.5178, GNorm = 1.0225, lr_0 = 6.5371e-04
Loss = 7.6263e-01, PNorm = 53.5723, GNorm = 2.1737, lr_0 = 6.3939e-04
Loss = 8.7379e-01, PNorm = 53.6083, GNorm = 1.6297, lr_0 = 6.2539e-04
Loss = 6.9898e-01, PNorm = 53.6272, GNorm = 1.0408, lr_0 = 6.1170e-04
Loss = 7.3869e-01, PNorm = 53.6561, GNorm = 0.7166, lr_0 = 5.9831e-04
Loss = 7.1801e-01, PNorm = 53.6909, GNorm = 0.8980, lr_0 = 5.8520e-04
Loss = 8.5983e-01, PNorm = 53.7183, GNorm = 0.8220, lr_0 = 5.7239e-04
Loss = 9.5656e-01, PNorm = 53.7457, GNorm = 0.9917, lr_0 = 5.5986e-04
Validation rmse = 0.184539
Epoch 4
Loss = 7.7410e-01, PNorm = 53.7830, GNorm = 1.3664, lr_0 = 5.4760e-04
Loss = 8.2409e-01, PNorm = 53.8036, GNorm = 1.1877, lr_0 = 5.3561e-04
Loss = 7.6952e-01, PNorm = 53.8364, GNorm = 1.2572, lr_0 = 5.2388e-04
Loss = 9.2965e-01, PNorm = 53.8544, GNorm = 1.1412, lr_0 = 5.1241e-04
Loss = 7.4244e-01, PNorm = 53.8906, GNorm = 0.5996, lr_0 = 5.0119e-04
Loss = 9.3121e-01, PNorm = 53.9248, GNorm = 0.7191, lr_0 = 4.9021e-04
Loss = 8.3202e-01, PNorm = 53.9473, GNorm = 1.2736, lr_0 = 4.7948e-04
Loss = 7.5970e-01, PNorm = 53.9752, GNorm = 0.9500, lr_0 = 4.6898e-04
Loss = 8.0045e-01, PNorm = 53.9970, GNorm = 1.1879, lr_0 = 4.5871e-04
Loss = 8.0888e-01, PNorm = 54.0208, GNorm = 0.9023, lr_0 = 4.4867e-04
Loss = 7.8934e-01, PNorm = 54.0487, GNorm = 1.0296, lr_0 = 4.3884e-04
Loss = 8.3120e-01, PNorm = 54.0820, GNorm = 1.0534, lr_0 = 4.2923e-04
Loss = 6.3914e-01, PNorm = 54.1047, GNorm = 0.8267, lr_0 = 4.1983e-04
Validation rmse = 0.183342
Epoch 5
Loss = 7.7303e-01, PNorm = 54.1376, GNorm = 1.2199, lr_0 = 4.0973e-04
Loss = 8.5048e-01, PNorm = 54.1667, GNorm = 1.0615, lr_0 = 4.0076e-04
Loss = 7.2424e-01, PNorm = 54.2012, GNorm = 0.9307, lr_0 = 3.9198e-04
Loss = 7.5279e-01, PNorm = 54.2259, GNorm = 0.5998, lr_0 = 3.8340e-04
Loss = 8.5464e-01, PNorm = 54.2529, GNorm = 1.3432, lr_0 = 3.7501e-04
Loss = 7.0107e-01, PNorm = 54.2766, GNorm = 0.9321, lr_0 = 3.6679e-04
Loss = 7.3657e-01, PNorm = 54.2959, GNorm = 0.8767, lr_0 = 3.5876e-04
Loss = 7.4083e-01, PNorm = 54.3178, GNorm = 0.8816, lr_0 = 3.5091e-04
Loss = 8.8177e-01, PNorm = 54.3341, GNorm = 1.3543, lr_0 = 3.4322e-04
Loss = 8.4571e-01, PNorm = 54.3570, GNorm = 0.8673, lr_0 = 3.3571e-04
Loss = 7.9604e-01, PNorm = 54.3798, GNorm = 0.8147, lr_0 = 3.2836e-04
Loss = 6.9421e-01, PNorm = 54.4033, GNorm = 0.7565, lr_0 = 3.2117e-04
Loss = 7.7769e-01, PNorm = 54.4229, GNorm = 1.4752, lr_0 = 3.1413e-04
Validation rmse = 0.185041
Epoch 6
Loss = 6.7468e-01, PNorm = 54.4383, GNorm = 1.5113, lr_0 = 3.0726e-04
Loss = 6.8680e-01, PNorm = 54.4568, GNorm = 1.3831, lr_0 = 3.0053e-04
Loss = 8.6879e-01, PNorm = 54.4756, GNorm = 1.0760, lr_0 = 2.9395e-04
Loss = 7.6163e-01, PNorm = 54.5123, GNorm = 2.0504, lr_0 = 2.8751e-04
Loss = 6.1113e-01, PNorm = 54.5306, GNorm = 1.0703, lr_0 = 2.8121e-04
Loss = 8.4069e-01, PNorm = 54.5545, GNorm = 1.3078, lr_0 = 2.7506e-04
Loss = 7.0992e-01, PNorm = 54.5755, GNorm = 1.3314, lr_0 = 2.6903e-04
Loss = 7.9482e-01, PNorm = 54.5923, GNorm = 0.8521, lr_0 = 2.6314e-04
Loss = 8.2531e-01, PNorm = 54.6089, GNorm = 0.8996, lr_0 = 2.5738e-04
Loss = 7.1668e-01, PNorm = 54.6284, GNorm = 0.9538, lr_0 = 2.5175e-04
Loss = 7.4188e-01, PNorm = 54.6461, GNorm = 0.9239, lr_0 = 2.4623e-04
Loss = 8.7009e-01, PNorm = 54.6659, GNorm = 1.3835, lr_0 = 2.4084e-04
Loss = 6.9812e-01, PNorm = 54.6783, GNorm = 1.1206, lr_0 = 2.3557e-04
Validation rmse = 0.180843
Epoch 7
Loss = 9.6176e-01, PNorm = 54.6995, GNorm = 0.7965, lr_0 = 2.3041e-04
Loss = 8.1903e-01, PNorm = 54.7193, GNorm = 1.1567, lr_0 = 2.2536e-04
Loss = 6.9354e-01, PNorm = 54.7331, GNorm = 1.0375, lr_0 = 2.2043e-04
Loss = 8.3921e-01, PNorm = 54.7453, GNorm = 1.3398, lr_0 = 2.1560e-04
Loss = 8.0103e-01, PNorm = 54.7623, GNorm = 1.6002, lr_0 = 2.1088e-04
Loss = 7.4055e-01, PNorm = 54.7803, GNorm = 0.9779, lr_0 = 2.0626e-04
Loss = 6.9873e-01, PNorm = 54.7980, GNorm = 1.1713, lr_0 = 2.0175e-04
Loss = 7.1347e-01, PNorm = 54.8111, GNorm = 1.5720, lr_0 = 1.9733e-04
Loss = 7.8089e-01, PNorm = 54.8205, GNorm = 0.9998, lr_0 = 1.9301e-04
Loss = 6.5850e-01, PNorm = 54.8348, GNorm = 1.1538, lr_0 = 1.8878e-04
Loss = 6.8015e-01, PNorm = 54.8484, GNorm = 0.7898, lr_0 = 1.8465e-04
Loss = 7.6690e-01, PNorm = 54.8634, GNorm = 1.2815, lr_0 = 1.8061e-04
Loss = 5.4952e-01, PNorm = 54.8765, GNorm = 0.8958, lr_0 = 1.7665e-04
Validation rmse = 0.180027
Epoch 8
Loss = 8.7205e-01, PNorm = 54.8863, GNorm = 1.3320, lr_0 = 1.7278e-04
Loss = 7.0698e-01, PNorm = 54.9051, GNorm = 1.2218, lr_0 = 1.6900e-04
Loss = 6.7082e-01, PNorm = 54.9185, GNorm = 0.9766, lr_0 = 1.6530e-04
Loss = 7.6877e-01, PNorm = 54.9274, GNorm = 1.6156, lr_0 = 1.6168e-04
Loss = 7.2066e-01, PNorm = 54.9374, GNorm = 0.8158, lr_0 = 1.5814e-04
Loss = 6.3064e-01, PNorm = 54.9495, GNorm = 1.1634, lr_0 = 1.5468e-04
Loss = 7.1641e-01, PNorm = 54.9588, GNorm = 1.2258, lr_0 = 1.5129e-04
Loss = 7.5648e-01, PNorm = 54.9677, GNorm = 1.6937, lr_0 = 1.4798e-04
Loss = 6.6665e-01, PNorm = 54.9737, GNorm = 1.4103, lr_0 = 1.4474e-04
Loss = 8.5484e-01, PNorm = 54.9790, GNorm = 1.7352, lr_0 = 1.4157e-04
Loss = 7.2073e-01, PNorm = 54.9922, GNorm = 1.3070, lr_0 = 1.3847e-04
Loss = 7.1152e-01, PNorm = 55.0029, GNorm = 1.4290, lr_0 = 1.3543e-04
Loss = 7.3260e-01, PNorm = 55.0139, GNorm = 1.6955, lr_0 = 1.3247e-04
Validation rmse = 0.177065
Epoch 9
Loss = 3.8553e-01, PNorm = 55.0236, GNorm = 1.0389, lr_0 = 1.2957e-04
Loss = 6.3739e-01, PNorm = 55.0303, GNorm = 1.2579, lr_0 = 1.2673e-04
Loss = 6.7586e-01, PNorm = 55.0392, GNorm = 0.9855, lr_0 = 1.2396e-04
Loss = 7.4108e-01, PNorm = 55.0465, GNorm = 1.0387, lr_0 = 1.2124e-04
Loss = 7.3264e-01, PNorm = 55.0532, GNorm = 0.8048, lr_0 = 1.1859e-04
Loss = 6.8799e-01, PNorm = 55.0602, GNorm = 1.5530, lr_0 = 1.1599e-04
Loss = 6.4060e-01, PNorm = 55.0682, GNorm = 1.0654, lr_0 = 1.1345e-04
Loss = 7.0496e-01, PNorm = 55.0734, GNorm = 1.0315, lr_0 = 1.1097e-04
Loss = 6.2003e-01, PNorm = 55.0803, GNorm = 1.7281, lr_0 = 1.0854e-04
Loss = 7.2427e-01, PNorm = 55.0861, GNorm = 2.8970, lr_0 = 1.0616e-04
Loss = 7.1624e-01, PNorm = 55.0925, GNorm = 1.1061, lr_0 = 1.0384e-04
Loss = 8.9407e-01, PNorm = 55.0994, GNorm = 0.9047, lr_0 = 1.0156e-04
Loss = 8.0693e-01, PNorm = 55.1054, GNorm = 0.8472, lr_0 = 1.0000e-04
Validation rmse = 0.182361
Model 0 best validation rmse = 0.177065 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.363428
Ensemble test rmse = 0.199959
1-fold cross validation
	Seed 42 ==> test rmse = 0.199959
Overall test rmse = 0.199959 +/- 0.000000
Elapsed time = 0:01:15
Command line
python main_script.py train all_amine_split_for_paper --epochs 10
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/train_clf.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 15,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2_clf',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/test_extra_x.csv'],
 'separate_test_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/test_clf.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/valid_extra_x.csv'],
 'separate_val_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_2/valid_clf.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['Encapsulation_Efficiency_EE<50',
                    'Encapsulation_Efficiency_50<=EE<80',
                    'Encapsulation_Efficiency_80<EE<=100',
                    'Delivery_target_lymph_nodes',
                    'chronic_toxicity_none',
                    'acute_toxicity_none',
                    'acute_toxicity_present',
                    'Delivery_target_dendritic_cell',
                    'Delivery_target_generic_cell',
                    'Delivery_target_macrophage',
                    'Delivery_target_lung_epithelium',
                    'Delivery_target_liver',
                    'Delivery_target_lung',
                    'Delivery_target_spleen',
                    'Delivery_target_muscle'],
 'target_weights': None,
 'task_names': ['Encapsulation_Efficiency_EE<50',
                'Encapsulation_Efficiency_50<=EE<80',
                'Encapsulation_Efficiency_80<EE<=100',
                'Delivery_target_lymph_nodes',
                'chronic_toxicity_none',
                'acute_toxicity_none',
                'acute_toxicity_present',
                'Delivery_target_dendritic_cell',
                'Delivery_target_generic_cell',
                'Delivery_target_macrophage',
                'Delivery_target_lung_epithelium',
                'Delivery_target_liver',
                'Delivery_target_lung',
                'Delivery_target_spleen',
                'Delivery_target_muscle'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 15
Fold 0
Splitting data with seed 42
Class sizes
Encapsulation_Efficiency_EE<50 0: 88.75%, 1: 11.25%
Encapsulation_Efficiency_50<=EE<80 0: 72.19%, 1: 27.81%
Encapsulation_Efficiency_80<EE<=100 0: 39.06%, 1: 60.94%
Delivery_target_lymph_nodes 0: 96.83%, 1: 3.17%
chronic_toxicity_none 0: 80.62%, 1: 19.38%
acute_toxicity_none 0: 32.81%, 1: 67.19%
acute_toxicity_present 0: 96.25%, 1: 3.75%
Delivery_target_dendritic_cell 0: 99.88%, 1: 0.12%
Delivery_target_generic_cell 0: 31.29%, 1: 68.71%
Delivery_target_macrophage 0: 99.64%, 1: 0.36%
Delivery_target_lung_epithelium 0: 81.69%, 1: 18.31%
Delivery_target_liver 0: 94.18%, 1: 5.82%
Delivery_target_lung 0: 99.41%, 1: 0.59%
Delivery_target_spleen 0: 98.17%, 1: 1.83%
Delivery_target_muscle 0: 96.28%, 1: 3.72%
Total size = 6,618 | train size = 6,618 | val size = 1,812 | test size = 1,599
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=621, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=15, bias=True)
  )
)
Number of parameters = 1,632,015
Moving model to cuda
Epoch 0
Loss = 5.5887e-01, PNorm = 52.3239, GNorm = 0.7897, lr_0 = 1.3750e-04
Loss = 2.5341e-01, PNorm = 52.3530, GNorm = 0.7960, lr_0 = 1.7159e-04
Loss = 1.7906e-01, PNorm = 52.3638, GNorm = 0.3951, lr_0 = 2.0568e-04
Loss = 1.6445e-01, PNorm = 52.3715, GNorm = 0.2777, lr_0 = 2.3977e-04
Loss = 1.2672e-01, PNorm = 52.3887, GNorm = 0.2643, lr_0 = 2.7386e-04
Loss = 1.1057e-01, PNorm = 52.4050, GNorm = 0.3996, lr_0 = 3.0795e-04
Loss = 8.0153e-02, PNorm = 52.4291, GNorm = 0.2594, lr_0 = 3.4205e-04
Loss = 7.8707e-02, PNorm = 52.4526, GNorm = 0.3477, lr_0 = 3.7614e-04
Loss = 8.1397e-02, PNorm = 52.4801, GNorm = 0.1267, lr_0 = 4.1023e-04
Loss = 5.9940e-02, PNorm = 52.5090, GNorm = 0.2466, lr_0 = 4.4432e-04
Loss = 4.9378e-02, PNorm = 52.5372, GNorm = 0.2227, lr_0 = 4.7841e-04
Loss = 6.2205e-02, PNorm = 52.5656, GNorm = 0.1467, lr_0 = 5.1250e-04
Loss = 4.8258e-02, PNorm = 52.5946, GNorm = 0.1393, lr_0 = 5.4659e-04
Warning: Found a task with targets all 0s or all 1s
Validation auc = nan
Epoch 1
Loss = 6.0953e-02, PNorm = 52.6342, GNorm = 0.1337, lr_0 = 5.8409e-04
Loss = 5.3017e-02, PNorm = 52.6575, GNorm = 0.1501, lr_0 = 6.1818e-04
Loss = 4.3496e-02, PNorm = 52.6991, GNorm = 0.1120, lr_0 = 6.5227e-04
Loss = 5.1310e-02, PNorm = 52.7374, GNorm = 0.1309, lr_0 = 6.8636e-04
Loss = 5.7654e-02, PNorm = 52.7678, GNorm = 0.1625, lr_0 = 7.2045e-04
Loss = 5.3217e-02, PNorm = 52.8110, GNorm = 0.1244, lr_0 = 7.5455e-04
Loss = 6.0802e-02, PNorm = 52.8649, GNorm = 0.1753, lr_0 = 7.8864e-04
Loss = 4.4916e-02, PNorm = 52.9105, GNorm = 0.0770, lr_0 = 8.2273e-04
Loss = 3.8112e-02, PNorm = 52.9602, GNorm = 0.0710, lr_0 = 8.5682e-04
Loss = 3.5786e-02, PNorm = 53.0161, GNorm = 0.0772, lr_0 = 8.9091e-04
Loss = 3.8667e-02, PNorm = 53.0705, GNorm = 0.1570, lr_0 = 9.2500e-04
Loss = 4.5436e-02, PNorm = 53.1295, GNorm = 0.0634, lr_0 = 9.5909e-04
Loss = 5.2042e-02, PNorm = 53.1946, GNorm = 0.1384, lr_0 = 9.9318e-04
Warning: Found a task with targets all 0s or all 1s
Validation auc = nan
Epoch 2
Loss = 6.1489e-02, PNorm = 53.2729, GNorm = 0.1209, lr_0 = 9.8057e-04
Loss = 4.7042e-02, PNorm = 53.3626, GNorm = 0.1027, lr_0 = 9.5942e-04
Loss = 5.7474e-02, PNorm = 53.4739, GNorm = 0.0845, lr_0 = 9.3872e-04
Loss = 3.6499e-02, PNorm = 53.5263, GNorm = 0.0825, lr_0 = 9.1848e-04
Loss = 3.7217e-02, PNorm = 53.6002, GNorm = 0.1256, lr_0 = 8.9867e-04
Loss = 4.5516e-02, PNorm = 53.6433, GNorm = 0.1069, lr_0 = 8.7928e-04
Loss = 3.9467e-02, PNorm = 53.7178, GNorm = 0.1047, lr_0 = 8.6032e-04
Loss = 3.5423e-02, PNorm = 53.7471, GNorm = 0.1145, lr_0 = 8.4176e-04
Loss = 4.2990e-02, PNorm = 53.7902, GNorm = 0.0684, lr_0 = 8.2361e-04
Loss = 4.3218e-02, PNorm = 53.8322, GNorm = 0.0609, lr_0 = 8.0584e-04
Loss = 3.8857e-02, PNorm = 53.8767, GNorm = 0.0754, lr_0 = 7.8846e-04
Loss = 4.6713e-02, PNorm = 53.9043, GNorm = 0.0985, lr_0 = 7.7146e-04
Loss = 3.0935e-02, PNorm = 53.9488, GNorm = 0.0202, lr_0 = 7.5482e-04
Warning: Found a task with targets all 0s or all 1s
Validation auc = nan
Epoch 3
Loss = 5.0196e-02, PNorm = 53.9722, GNorm = 0.0772, lr_0 = 7.3854e-04
Loss = 3.6027e-02, PNorm = 54.0053, GNorm = 0.1260, lr_0 = 7.2261e-04
Loss = 3.8271e-02, PNorm = 54.0556, GNorm = 0.0701, lr_0 = 7.0702e-04
Loss = 4.9529e-02, PNorm = 54.0749, GNorm = 0.1159, lr_0 = 6.9177e-04
Loss = 4.3621e-02, PNorm = 54.1322, GNorm = 0.0683, lr_0 = 6.7685e-04
Loss = 4.1498e-02, PNorm = 54.1644, GNorm = 0.0889, lr_0 = 6.6225e-04
Loss = 4.3717e-02, PNorm = 54.1962, GNorm = 0.0878, lr_0 = 6.4797e-04
Loss = 3.1933e-02, PNorm = 54.2215, GNorm = 0.0314, lr_0 = 6.3399e-04
Loss = 3.0277e-02, PNorm = 54.2577, GNorm = 0.0585, lr_0 = 6.2032e-04
Loss = 3.3377e-02, PNorm = 54.2971, GNorm = 0.1916, lr_0 = 6.0694e-04
Loss = 4.9179e-02, PNorm = 54.3258, GNorm = 0.1152, lr_0 = 5.9385e-04
Loss = 4.2029e-02, PNorm = 54.3974, GNorm = 0.1761, lr_0 = 5.8104e-04
Loss = 5.2362e-02, PNorm = 54.4434, GNorm = 0.0699, lr_0 = 5.6851e-04
Warning: Found a task with targets all 0s or all 1s
Validation auc = nan
Epoch 4
Loss = 4.1568e-02, PNorm = 54.5019, GNorm = 0.1156, lr_0 = 5.5503e-04
Loss = 4.0894e-02, PNorm = 54.5403, GNorm = 0.0957, lr_0 = 5.4306e-04
Loss = 3.9188e-02, PNorm = 54.6014, GNorm = 0.0715, lr_0 = 5.3135e-04
Loss = 3.0197e-02, PNorm = 54.6275, GNorm = 0.0744, lr_0 = 5.1989e-04
Loss = 2.8808e-02, PNorm = 54.6482, GNorm = 0.0950, lr_0 = 5.0867e-04
Loss = 3.9954e-02, PNorm = 54.6792, GNorm = 0.0594, lr_0 = 4.9770e-04
Loss = 3.7050e-02, PNorm = 54.7153, GNorm = 0.0823, lr_0 = 4.8697e-04
Loss = 3.4407e-02, PNorm = 54.7572, GNorm = 0.0709, lr_0 = 4.7646e-04
Loss = 2.9280e-02, PNorm = 54.7943, GNorm = 0.0467, lr_0 = 4.6619e-04
Loss = 3.2851e-02, PNorm = 54.8363, GNorm = 0.1167, lr_0 = 4.5613e-04
Loss = 3.0883e-02, PNorm = 54.8784, GNorm = 0.0575, lr_0 = 4.4629e-04
Loss = 4.3181e-02, PNorm = 54.8984, GNorm = 0.0776, lr_0 = 4.3667e-04
Loss = 2.8243e-02, PNorm = 54.9314, GNorm = 0.0406, lr_0 = 4.2725e-04
Loss = 3.4054e-02, PNorm = 54.9647, GNorm = 0.0869, lr_0 = 4.1803e-04
Warning: Found a task with targets all 0s or all 1s
Validation auc = nan
Epoch 5
Loss = 3.2297e-02, PNorm = 54.9919, GNorm = 0.0609, lr_0 = 4.0813e-04
Loss = 3.1924e-02, PNorm = 55.0309, GNorm = 0.0624, lr_0 = 3.9932e-04
Loss = 3.5755e-02, PNorm = 55.0519, GNorm = 0.0512, lr_0 = 3.9071e-04
Loss = 3.0822e-02, PNorm = 55.0985, GNorm = 0.0976, lr_0 = 3.8228e-04
Loss = 2.2025e-02, PNorm = 55.1258, GNorm = 0.0385, lr_0 = 3.7404e-04
Loss = 3.6259e-02, PNorm = 55.1373, GNorm = 0.1323, lr_0 = 3.6597e-04
Loss = 2.8715e-02, PNorm = 55.1537, GNorm = 0.1029, lr_0 = 3.5808e-04
Loss = 3.1730e-02, PNorm = 55.1800, GNorm = 0.0379, lr_0 = 3.5035e-04
Loss = 3.7478e-02, PNorm = 55.1934, GNorm = 0.0967, lr_0 = 3.4280e-04
Loss = 4.1169e-02, PNorm = 55.2315, GNorm = 0.1149, lr_0 = 3.3540e-04
Loss = 3.4861e-02, PNorm = 55.2646, GNorm = 0.0548, lr_0 = 3.2817e-04
Loss = 3.6663e-02, PNorm = 55.2800, GNorm = 0.1091, lr_0 = 3.2109e-04
Loss = 3.8591e-02, PNorm = 55.2836, GNorm = 0.1376, lr_0 = 3.1417e-04
Warning: Found a task with targets all 0s or all 1s
Validation auc = nan
Epoch 6
Loss = 3.1161e-02, PNorm = 55.3211, GNorm = 0.0593, lr_0 = 3.0739e-04
Loss = 4.0488e-02, PNorm = 55.3434, GNorm = 0.0860, lr_0 = 3.0076e-04
Loss = 4.7696e-02, PNorm = 55.3724, GNorm = 0.0855, lr_0 = 2.9427e-04
Loss = 2.5649e-02, PNorm = 55.4019, GNorm = 0.0969, lr_0 = 2.8793e-04
Loss = 3.4860e-02, PNorm = 55.3988, GNorm = 0.0533, lr_0 = 2.8172e-04
Loss = 3.4067e-02, PNorm = 55.4116, GNorm = 0.1513, lr_0 = 2.7564e-04
Loss = 2.9100e-02, PNorm = 55.4404, GNorm = 0.0454, lr_0 = 2.6969e-04
Loss = 3.0499e-02, PNorm = 55.4684, GNorm = 0.0561, lr_0 = 2.6388e-04
Loss = 2.8666e-02, PNorm = 55.4892, GNorm = 0.0868, lr_0 = 2.5819e-04
Loss = 3.5210e-02, PNorm = 55.5012, GNorm = 0.1466, lr_0 = 2.5262e-04
Loss = 3.4689e-02, PNorm = 55.5061, GNorm = 0.0914, lr_0 = 2.4717e-04
Loss = 3.1135e-02, PNorm = 55.5307, GNorm = 0.0315, lr_0 = 2.4184e-04
Loss = 2.7192e-02, PNorm = 55.5515, GNorm = 0.1033, lr_0 = 2.3662e-04
Warning: Found a task with targets all 0s or all 1s
Validation auc = nan
Epoch 7
Loss = 4.6346e-02, PNorm = 55.5636, GNorm = 0.1102, lr_0 = 2.3101e-04
Loss = 2.9342e-02, PNorm = 55.5734, GNorm = 0.0887, lr_0 = 2.2603e-04
Loss = 3.4115e-02, PNorm = 55.5936, GNorm = 0.1556, lr_0 = 2.2116e-04
Loss = 2.3866e-02, PNorm = 55.6145, GNorm = 0.1147, lr_0 = 2.1639e-04
Loss = 3.3284e-02, PNorm = 55.6314, GNorm = 0.0947, lr_0 = 2.1172e-04
Loss = 3.0388e-02, PNorm = 55.6419, GNorm = 0.1480, lr_0 = 2.0715e-04
Loss = 3.7701e-02, PNorm = 55.6523, GNorm = 0.0990, lr_0 = 2.0268e-04
Loss = 2.5132e-02, PNorm = 55.6675, GNorm = 0.0456, lr_0 = 1.9831e-04
Loss = 3.6419e-02, PNorm = 55.6785, GNorm = 0.1102, lr_0 = 1.9403e-04
Loss = 2.1218e-02, PNorm = 55.6896, GNorm = 0.0849, lr_0 = 1.8985e-04
Loss = 2.3145e-02, PNorm = 55.6994, GNorm = 0.1038, lr_0 = 1.8575e-04
Loss = 2.3057e-02, PNorm = 55.7062, GNorm = 0.0479, lr_0 = 1.8175e-04
Loss = 3.2602e-02, PNorm = 55.7117, GNorm = 0.1000, lr_0 = 1.7783e-04
Warning: Found a task with targets all 0s or all 1s
Validation auc = nan
Epoch 8
Loss = 2.6328e-02, PNorm = 55.7232, GNorm = 0.0699, lr_0 = 1.7361e-04
Loss = 2.4373e-02, PNorm = 55.7356, GNorm = 0.0748, lr_0 = 1.6987e-04
Loss = 1.9107e-02, PNorm = 55.7484, GNorm = 0.0583, lr_0 = 1.6620e-04
Loss = 3.1730e-02, PNorm = 55.7572, GNorm = 0.1068, lr_0 = 1.6262e-04
Loss = 3.8549e-02, PNorm = 55.7661, GNorm = 0.0976, lr_0 = 1.5911e-04
Loss = 3.1425e-02, PNorm = 55.7720, GNorm = 0.0616, lr_0 = 1.5568e-04
Loss = 2.2686e-02, PNorm = 55.7790, GNorm = 0.0633, lr_0 = 1.5232e-04
Loss = 3.9201e-02, PNorm = 55.7866, GNorm = 0.1159, lr_0 = 1.4904e-04
Loss = 2.7530e-02, PNorm = 55.7998, GNorm = 0.0762, lr_0 = 1.4582e-04
Loss = 3.0042e-02, PNorm = 55.8084, GNorm = 0.1285, lr_0 = 1.4268e-04
Loss = 2.2241e-02, PNorm = 55.8195, GNorm = 0.0683, lr_0 = 1.3960e-04
Loss = 3.2059e-02, PNorm = 55.8283, GNorm = 0.0758, lr_0 = 1.3659e-04
Loss = 3.2413e-02, PNorm = 55.8324, GNorm = 0.1242, lr_0 = 1.3364e-04
Loss = 2.5269e-02, PNorm = 55.8405, GNorm = 0.1077, lr_0 = 1.3076e-04
Warning: Found a task with targets all 0s or all 1s
Validation auc = nan
Epoch 9
Loss = 2.2882e-02, PNorm = 55.8487, GNorm = 0.0933, lr_0 = 1.2794e-04
Loss = 2.8071e-02, PNorm = 55.8535, GNorm = 0.1048, lr_0 = 1.2518e-04
Loss = 2.7115e-02, PNorm = 55.8600, GNorm = 0.1123, lr_0 = 1.2248e-04
Loss = 2.9282e-02, PNorm = 55.8682, GNorm = 0.1218, lr_0 = 1.1984e-04
Loss = 2.1589e-02, PNorm = 55.8775, GNorm = 0.0567, lr_0 = 1.1725e-04
Loss = 2.4396e-02, PNorm = 55.8833, GNorm = 0.0539, lr_0 = 1.1473e-04
Loss = 2.9115e-02, PNorm = 55.8897, GNorm = 0.1348, lr_0 = 1.1225e-04
Loss = 2.7232e-02, PNorm = 55.8944, GNorm = 0.0488, lr_0 = 1.0983e-04
Loss = 2.7380e-02, PNorm = 55.8981, GNorm = 0.1391, lr_0 = 1.0746e-04
Loss = 3.2915e-02, PNorm = 55.8991, GNorm = 0.0961, lr_0 = 1.0514e-04
Loss = 3.5780e-02, PNorm = 55.9043, GNorm = 0.2286, lr_0 = 1.0288e-04
Loss = 3.1124e-02, PNorm = 55.9100, GNorm = 0.1230, lr_0 = 1.0066e-04
Loss = 3.1564e-02, PNorm = 55.9164, GNorm = 0.1427, lr_0 = 1.0000e-04
Warning: Found a task with targets all 0s or all 1s
Validation auc = nan
Model 0 best validation auc = -inf on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test auc = 0.549145
Ensemble test auc = 0.549145
1-fold cross validation
	Seed 42 ==> test auc = 0.549145
Overall test auc = 0.549145 +/- 0.000000
Elapsed time = 0:01:16
Command line
python main_script.py train all_amine_split_for_paper --epochs 10
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 9,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [0.05, 0.05, 0.05, 0.05, 0.95, 0.95, 0.95, 0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/test_extra_x.csv'],
 'separate_test_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/valid_extra_x.csv'],
 'separate_val_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['Biodistribution_heart',
                    'Biodistribution_kidney',
                    'Biodistribution_liver',
                    'Biodistribution_lung',
                    'Biodistribution_lymph_nodes',
                    'Biodistribution_muscle',
                    'Biodistribution_spleen',
                    'quantified_delivery',
                    'quantified_total_luminescence'],
 'target_weights': None,
 'task_names': ['Biodistribution_heart',
                'Biodistribution_kidney',
                'Biodistribution_liver',
                'Biodistribution_lung',
                'Biodistribution_lymph_nodes',
                'Biodistribution_muscle',
                'Biodistribution_spleen',
                'quantified_delivery',
                'quantified_total_luminescence'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 9
Fold 0
Splitting data with seed 42
Total size = 6,531 | train size = 6,531 | val size = 1,628 | test size = 1,812
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=621, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=9, bias=True)
  )
)
Number of parameters = 1,628,409
Moving model to cuda
Epoch 0
Loss = 1.0189e+00, PNorm = 52.2045, GNorm = 2.3302, lr_0 = 1.3808e-04
Loss = 1.0047e+00, PNorm = 52.2068, GNorm = 3.0095, lr_0 = 1.7269e-04
Loss = 7.8634e-01, PNorm = 52.2091, GNorm = 2.9598, lr_0 = 2.0731e-04
Loss = 1.0404e+00, PNorm = 52.2144, GNorm = 2.0216, lr_0 = 2.4192e-04
Loss = 1.0185e+00, PNorm = 52.2195, GNorm = 2.3780, lr_0 = 2.7654e-04
Loss = 1.0457e+00, PNorm = 52.2262, GNorm = 1.7561, lr_0 = 3.1115e-04
Loss = 8.7959e-01, PNorm = 52.2356, GNorm = 1.1040, lr_0 = 3.4577e-04
Loss = 1.0143e+00, PNorm = 52.2463, GNorm = 1.8822, lr_0 = 3.8038e-04
Loss = 1.0292e+00, PNorm = 52.2596, GNorm = 0.9903, lr_0 = 4.1500e-04
Loss = 8.2146e-01, PNorm = 52.2788, GNorm = 1.6957, lr_0 = 4.4962e-04
Loss = 1.0036e+00, PNorm = 52.2951, GNorm = 1.4826, lr_0 = 4.8423e-04
Loss = 9.1746e-01, PNorm = 52.3154, GNorm = 1.8558, lr_0 = 5.1885e-04
Loss = 1.0192e+00, PNorm = 52.3318, GNorm = 1.6131, lr_0 = 5.5346e-04
Loss = 1.1372e+00, PNorm = 52.3337, GNorm = 2.4784, lr_0 = 5.5692e-04
Validation rmse = 0.146437
Epoch 1
Loss = 8.2166e-01, PNorm = 52.3582, GNorm = 1.2782, lr_0 = 5.9154e-04
Loss = 9.9428e-01, PNorm = 52.3807, GNorm = 1.4369, lr_0 = 6.2615e-04
Loss = 9.1045e-01, PNorm = 52.4082, GNorm = 1.4575, lr_0 = 6.6077e-04
Loss = 7.6173e-01, PNorm = 52.4402, GNorm = 1.2227, lr_0 = 6.9538e-04
Loss = 9.9762e-01, PNorm = 52.4657, GNorm = 1.1649, lr_0 = 7.3000e-04
Loss = 1.0453e+00, PNorm = 52.5049, GNorm = 1.6553, lr_0 = 7.6462e-04
Loss = 1.2315e+00, PNorm = 52.5404, GNorm = 2.1162, lr_0 = 7.9923e-04
Loss = 8.9122e-01, PNorm = 52.5733, GNorm = 1.0675, lr_0 = 8.3385e-04
Loss = 8.3054e-01, PNorm = 52.6131, GNorm = 1.4928, lr_0 = 8.6846e-04
Loss = 7.8220e-01, PNorm = 52.6520, GNorm = 1.6261, lr_0 = 9.0308e-04
Loss = 9.7796e-01, PNorm = 52.6823, GNorm = 1.0361, lr_0 = 9.3769e-04
Loss = 1.0433e+00, PNorm = 52.7254, GNorm = 1.1550, lr_0 = 9.7231e-04
Loss = 9.1252e-01, PNorm = 52.7733, GNorm = 1.5895, lr_0 = 9.9558e-04
Validation rmse = 0.159837
Epoch 2
Loss = 9.0926e-01, PNorm = 52.8197, GNorm = 0.8135, lr_0 = 9.7378e-04
Loss = 9.0481e-01, PNorm = 52.8659, GNorm = 0.8779, lr_0 = 9.5246e-04
Loss = 8.5985e-01, PNorm = 52.9189, GNorm = 1.1193, lr_0 = 9.3160e-04
Loss = 7.8473e-01, PNorm = 52.9733, GNorm = 1.1272, lr_0 = 9.1120e-04
Loss = 9.4243e-01, PNorm = 53.0157, GNorm = 0.9905, lr_0 = 8.9125e-04
Loss = 8.1239e-01, PNorm = 53.0717, GNorm = 0.9526, lr_0 = 8.7174e-04
Loss = 8.1976e-01, PNorm = 53.1164, GNorm = 1.1646, lr_0 = 8.5265e-04
Loss = 8.4309e-01, PNorm = 53.1586, GNorm = 0.9704, lr_0 = 8.3398e-04
Loss = 9.9645e-01, PNorm = 53.1953, GNorm = 1.3233, lr_0 = 8.1572e-04
Loss = 8.3299e-01, PNorm = 53.2344, GNorm = 1.1775, lr_0 = 7.9785e-04
Loss = 9.8913e-01, PNorm = 53.2948, GNorm = 0.8881, lr_0 = 7.8038e-04
Loss = 9.7228e-01, PNorm = 53.3348, GNorm = 0.8396, lr_0 = 7.6329e-04
Loss = 9.3713e-01, PNorm = 53.3633, GNorm = 0.7606, lr_0 = 7.4658e-04
Validation rmse = 0.148390
Epoch 3
Loss = 9.9758e-01, PNorm = 53.4039, GNorm = 0.9471, lr_0 = 7.2862e-04
Loss = 7.4737e-01, PNorm = 53.4306, GNorm = 1.3333, lr_0 = 7.1266e-04
Loss = 7.4534e-01, PNorm = 53.4673, GNorm = 1.0028, lr_0 = 6.9706e-04
Loss = 7.5772e-01, PNorm = 53.5049, GNorm = 1.3530, lr_0 = 6.8180e-04
Loss = 9.3152e-01, PNorm = 53.5529, GNorm = 0.8389, lr_0 = 6.6687e-04
Loss = 8.7534e-01, PNorm = 53.5899, GNorm = 1.2746, lr_0 = 6.5226e-04
Loss = 8.3874e-01, PNorm = 53.6351, GNorm = 1.1504, lr_0 = 6.3798e-04
Loss = 9.8313e-01, PNorm = 53.6695, GNorm = 1.4714, lr_0 = 6.2401e-04
Loss = 8.6252e-01, PNorm = 53.6996, GNorm = 0.8063, lr_0 = 6.1035e-04
Loss = 7.0651e-01, PNorm = 53.7270, GNorm = 1.1204, lr_0 = 5.9698e-04
Loss = 8.8395e-01, PNorm = 53.7537, GNorm = 1.0561, lr_0 = 5.8391e-04
Loss = 9.1883e-01, PNorm = 53.7912, GNorm = 1.2623, lr_0 = 5.7112e-04
Loss = 7.5637e-01, PNorm = 53.8313, GNorm = 0.9672, lr_0 = 5.5862e-04
Validation rmse = 0.145667
Epoch 4
Loss = 7.1715e-01, PNorm = 53.8689, GNorm = 1.5802, lr_0 = 5.4639e-04
Loss = 7.1973e-01, PNorm = 53.9100, GNorm = 0.7303, lr_0 = 5.3442e-04
Loss = 8.4002e-01, PNorm = 53.9489, GNorm = 1.0612, lr_0 = 5.2272e-04
Loss = 8.5298e-01, PNorm = 53.9871, GNorm = 1.6541, lr_0 = 5.1127e-04
Loss = 8.9513e-01, PNorm = 54.0205, GNorm = 1.1436, lr_0 = 5.0008e-04
Loss = 8.7613e-01, PNorm = 54.0574, GNorm = 1.0553, lr_0 = 4.8913e-04
Loss = 7.8560e-01, PNorm = 54.0887, GNorm = 0.5919, lr_0 = 4.7842e-04
Loss = 8.7235e-01, PNorm = 54.1303, GNorm = 1.4050, lr_0 = 4.6794e-04
Loss = 7.3840e-01, PNorm = 54.1659, GNorm = 1.0754, lr_0 = 4.5770e-04
Loss = 7.5825e-01, PNorm = 54.2104, GNorm = 0.7815, lr_0 = 4.4767e-04
Loss = 7.8596e-01, PNorm = 54.2447, GNorm = 0.8849, lr_0 = 4.3787e-04
Loss = 8.9001e-01, PNorm = 54.2913, GNorm = 0.7507, lr_0 = 4.2828e-04
Loss = 8.7339e-01, PNorm = 54.3328, GNorm = 0.9373, lr_0 = 4.1890e-04
Validation rmse = 0.138247
Epoch 5
Loss = 8.8614e-01, PNorm = 54.3565, GNorm = 1.2734, lr_0 = 4.0973e-04
Loss = 9.4521e-01, PNorm = 54.3860, GNorm = 1.0933, lr_0 = 4.0076e-04
Loss = 8.1581e-01, PNorm = 54.4314, GNorm = 1.3620, lr_0 = 3.9198e-04
Loss = 6.8870e-01, PNorm = 54.4654, GNorm = 1.0236, lr_0 = 3.8340e-04
Loss = 8.6926e-01, PNorm = 54.4934, GNorm = 1.1494, lr_0 = 3.7501e-04
Loss = 8.2300e-01, PNorm = 54.5199, GNorm = 1.1775, lr_0 = 3.6679e-04
Loss = 6.5730e-01, PNorm = 54.5475, GNorm = 0.6220, lr_0 = 3.5876e-04
Loss = 9.0808e-01, PNorm = 54.5730, GNorm = 1.3500, lr_0 = 3.5091e-04
Loss = 7.1801e-01, PNorm = 54.5940, GNorm = 1.2540, lr_0 = 3.4322e-04
Loss = 9.2337e-01, PNorm = 54.6171, GNorm = 1.0797, lr_0 = 3.3571e-04
Loss = 7.3063e-01, PNorm = 54.6410, GNorm = 1.1832, lr_0 = 3.2836e-04
Loss = 6.0352e-01, PNorm = 54.6611, GNorm = 1.2977, lr_0 = 3.2117e-04
Loss = 7.9099e-01, PNorm = 54.6829, GNorm = 1.0127, lr_0 = 3.1413e-04
Validation rmse = 0.134112
Epoch 6
Loss = 7.1045e-01, PNorm = 54.7175, GNorm = 1.2679, lr_0 = 3.0658e-04
Loss = 7.1617e-01, PNorm = 54.7469, GNorm = 0.9565, lr_0 = 2.9986e-04
Loss = 7.1025e-01, PNorm = 54.7611, GNorm = 0.9133, lr_0 = 2.9330e-04
Loss = 6.5075e-01, PNorm = 54.7734, GNorm = 1.0469, lr_0 = 2.8687e-04
Loss = 7.5726e-01, PNorm = 54.7926, GNorm = 0.8595, lr_0 = 2.8059e-04
Loss = 8.2584e-01, PNorm = 54.8116, GNorm = 0.9739, lr_0 = 2.7445e-04
Loss = 7.9023e-01, PNorm = 54.8326, GNorm = 1.3907, lr_0 = 2.6844e-04
Loss = 7.3117e-01, PNorm = 54.8631, GNorm = 1.7711, lr_0 = 2.6256e-04
Loss = 8.2392e-01, PNorm = 54.8807, GNorm = 1.2976, lr_0 = 2.5681e-04
Loss = 7.1705e-01, PNorm = 54.9021, GNorm = 1.4078, lr_0 = 2.5119e-04
Loss = 7.7344e-01, PNorm = 54.9210, GNorm = 0.8165, lr_0 = 2.4569e-04
Loss = 8.4643e-01, PNorm = 54.9402, GNorm = 1.4086, lr_0 = 2.4031e-04
Loss = 8.6766e-01, PNorm = 54.9548, GNorm = 1.0236, lr_0 = 2.3505e-04
Validation rmse = 0.134464
Epoch 7
Loss = 7.6159e-01, PNorm = 54.9711, GNorm = 1.1463, lr_0 = 2.2990e-04
Loss = 7.6702e-01, PNorm = 54.9921, GNorm = 1.1308, lr_0 = 2.2487e-04
Loss = 7.4973e-01, PNorm = 55.0091, GNorm = 0.9565, lr_0 = 2.1994e-04
Loss = 7.4558e-01, PNorm = 55.0254, GNorm = 1.0239, lr_0 = 2.1513e-04
Loss = 8.2985e-01, PNorm = 55.0384, GNorm = 1.0227, lr_0 = 2.1042e-04
Loss = 7.4299e-01, PNorm = 55.0493, GNorm = 1.1658, lr_0 = 2.0581e-04
Loss = 7.8240e-01, PNorm = 55.0625, GNorm = 1.1778, lr_0 = 2.0130e-04
Loss = 8.1798e-01, PNorm = 55.0754, GNorm = 1.4860, lr_0 = 1.9689e-04
Loss = 7.1578e-01, PNorm = 55.0890, GNorm = 1.1620, lr_0 = 1.9258e-04
Loss = 6.8199e-01, PNorm = 55.1020, GNorm = 1.1566, lr_0 = 1.8836e-04
Loss = 6.9580e-01, PNorm = 55.1156, GNorm = 0.9577, lr_0 = 1.8424e-04
Loss = 7.3487e-01, PNorm = 55.1267, GNorm = 1.0852, lr_0 = 1.8021e-04
Loss = 6.3078e-01, PNorm = 55.1395, GNorm = 1.3450, lr_0 = 1.7626e-04
Validation rmse = 0.135925
Epoch 8
Loss = 8.3394e-01, PNorm = 55.1509, GNorm = 1.5641, lr_0 = 1.7202e-04
Loss = 6.9943e-01, PNorm = 55.1627, GNorm = 1.3019, lr_0 = 1.6825e-04
Loss = 5.8070e-01, PNorm = 55.1716, GNorm = 1.0300, lr_0 = 1.6457e-04
Loss = 7.5887e-01, PNorm = 55.1794, GNorm = 1.5728, lr_0 = 1.6096e-04
Loss = 6.0755e-01, PNorm = 55.1883, GNorm = 0.7500, lr_0 = 1.5744e-04
Loss = 7.1157e-01, PNorm = 55.1980, GNorm = 1.7370, lr_0 = 1.5399e-04
Loss = 7.4056e-01, PNorm = 55.2087, GNorm = 1.2479, lr_0 = 1.5062e-04
Loss = 9.0529e-01, PNorm = 55.2210, GNorm = 1.1163, lr_0 = 1.4732e-04
Loss = 7.7951e-01, PNorm = 55.2308, GNorm = 2.0709, lr_0 = 1.4410e-04
Loss = 8.7527e-01, PNorm = 55.2396, GNorm = 1.6904, lr_0 = 1.4094e-04
Loss = 7.4459e-01, PNorm = 55.2507, GNorm = 1.8005, lr_0 = 1.3786e-04
Loss = 6.2197e-01, PNorm = 55.2617, GNorm = 0.8000, lr_0 = 1.3484e-04
Loss = 7.0389e-01, PNorm = 55.2689, GNorm = 1.0760, lr_0 = 1.3188e-04
Validation rmse = 0.135035
Epoch 9
Loss = 6.6044e-01, PNorm = 55.2777, GNorm = 1.1150, lr_0 = 1.2900e-04
Loss = 6.7964e-01, PNorm = 55.2858, GNorm = 1.4076, lr_0 = 1.2617e-04
Loss = 6.6994e-01, PNorm = 55.2928, GNorm = 1.5057, lr_0 = 1.2341e-04
Loss = 6.1120e-01, PNorm = 55.2984, GNorm = 1.1963, lr_0 = 1.2071e-04
Loss = 9.0322e-01, PNorm = 55.3012, GNorm = 1.0313, lr_0 = 1.1806e-04
Loss = 7.2578e-01, PNorm = 55.3065, GNorm = 1.9424, lr_0 = 1.1548e-04
Loss = 7.0830e-01, PNorm = 55.3165, GNorm = 1.3541, lr_0 = 1.1295e-04
Loss = 8.3794e-01, PNorm = 55.3231, GNorm = 1.4406, lr_0 = 1.1048e-04
Loss = 6.0309e-01, PNorm = 55.3276, GNorm = 0.8677, lr_0 = 1.0806e-04
Loss = 7.9742e-01, PNorm = 55.3330, GNorm = 0.9777, lr_0 = 1.0569e-04
Loss = 7.7197e-01, PNorm = 55.3397, GNorm = 0.9954, lr_0 = 1.0338e-04
Loss = 6.6322e-01, PNorm = 55.3451, GNorm = 0.8618, lr_0 = 1.0111e-04
Loss = 6.1900e-01, PNorm = 55.3491, GNorm = 0.9320, lr_0 = 1.0000e-04
Validation rmse = 0.132296
Model 0 best validation rmse = 0.132296 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.333650
Ensemble test rmse = 0.193032
1-fold cross validation
	Seed 42 ==> test rmse = 0.193032
Overall test rmse = 0.193032 +/- 0.000000
Elapsed time = 0:01:15
Command line
python main_script.py train all_amine_split_for_paper --epochs 10
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/train_clf.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 15,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3_clf',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/test_extra_x.csv'],
 'separate_test_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/test_clf.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/valid_extra_x.csv'],
 'separate_val_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_3/valid_clf.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['Encapsulation_Efficiency_EE<50',
                    'Encapsulation_Efficiency_50<=EE<80',
                    'Encapsulation_Efficiency_80<EE<=100',
                    'Delivery_target_lymph_nodes',
                    'chronic_toxicity_none',
                    'acute_toxicity_none',
                    'acute_toxicity_present',
                    'Delivery_target_dendritic_cell',
                    'Delivery_target_generic_cell',
                    'Delivery_target_macrophage',
                    'Delivery_target_lung_epithelium',
                    'Delivery_target_liver',
                    'Delivery_target_lung',
                    'Delivery_target_spleen',
                    'Delivery_target_muscle'],
 'target_weights': None,
 'task_names': ['Encapsulation_Efficiency_EE<50',
                'Encapsulation_Efficiency_50<=EE<80',
                'Encapsulation_Efficiency_80<EE<=100',
                'Delivery_target_lymph_nodes',
                'chronic_toxicity_none',
                'acute_toxicity_none',
                'acute_toxicity_present',
                'Delivery_target_dendritic_cell',
                'Delivery_target_generic_cell',
                'Delivery_target_macrophage',
                'Delivery_target_lung_epithelium',
                'Delivery_target_liver',
                'Delivery_target_lung',
                'Delivery_target_spleen',
                'Delivery_target_muscle'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 15
Fold 0
Splitting data with seed 42
Class sizes
Encapsulation_Efficiency_EE<50 0: 84.08%, 1: 15.92%
Encapsulation_Efficiency_50<=EE<80 0: 82.86%, 1: 17.14%
Encapsulation_Efficiency_80<EE<=100 0: 33.06%, 1: 66.94%
Delivery_target_lymph_nodes 0: 96.04%, 1: 3.96%
chronic_toxicity_none 0: 67.35%, 1: 32.65%
acute_toxicity_none 0: 52.24%, 1: 47.76%
acute_toxicity_present 0: 95.51%, 1: 4.49%
Delivery_target_dendritic_cell 0: 99.88%, 1: 0.12%
Delivery_target_generic_cell 0: 31.04%, 1: 68.96%
Delivery_target_macrophage 0: 99.64%, 1: 0.36%
Delivery_target_lung_epithelium 0: 81.86%, 1: 18.14%
Delivery_target_liver 0: 93.74%, 1: 6.26%
Delivery_target_lung 0: 99.36%, 1: 0.64%
Delivery_target_spleen 0: 98.01%, 1: 1.99%
Delivery_target_muscle 0: 96.92%, 1: 3.08%
Total size = 6,597 | train size = 6,597 | val size = 1,628 | test size = 1,812
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=621, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=15, bias=True)
  )
)
Number of parameters = 1,632,015
Moving model to cuda
Epoch 0
Loss = 5.5471e-01, PNorm = 52.3240, GNorm = 0.9370, lr_0 = 1.3779e-04
Loss = 2.4062e-01, PNorm = 52.3537, GNorm = 0.9083, lr_0 = 1.7214e-04
Loss = 1.9576e-01, PNorm = 52.3636, GNorm = 0.3596, lr_0 = 2.0649e-04
Loss = 1.5748e-01, PNorm = 52.3717, GNorm = 0.4281, lr_0 = 2.4084e-04
Loss = 1.1604e-01, PNorm = 52.3893, GNorm = 0.3827, lr_0 = 2.7519e-04
Loss = 9.7826e-02, PNorm = 52.4061, GNorm = 0.2469, lr_0 = 3.0954e-04
Loss = 9.3259e-02, PNorm = 52.4297, GNorm = 0.3084, lr_0 = 3.4389e-04
Loss = 7.2989e-02, PNorm = 52.4563, GNorm = 0.3217, lr_0 = 3.7824e-04
Loss = 7.6866e-02, PNorm = 52.4848, GNorm = 0.2191, lr_0 = 4.1260e-04
Loss = 5.8717e-02, PNorm = 52.5139, GNorm = 0.1888, lr_0 = 4.4695e-04
Loss = 6.0618e-02, PNorm = 52.5427, GNorm = 0.2359, lr_0 = 4.8130e-04
Loss = 6.3549e-02, PNorm = 52.5707, GNorm = 0.1883, lr_0 = 5.1565e-04
Loss = 6.0354e-02, PNorm = 52.6042, GNorm = 0.1935, lr_0 = 5.5000e-04
Validation auc = 0.770587
Epoch 1
Loss = 5.3367e-02, PNorm = 52.6426, GNorm = 0.1682, lr_0 = 5.8779e-04
Loss = 4.4180e-02, PNorm = 52.6842, GNorm = 0.1905, lr_0 = 6.2214e-04
Loss = 4.7567e-02, PNorm = 52.7187, GNorm = 0.1198, lr_0 = 6.5649e-04
Loss = 4.8157e-02, PNorm = 52.7672, GNorm = 0.0894, lr_0 = 6.9084e-04
Loss = 5.6056e-02, PNorm = 52.8107, GNorm = 0.1251, lr_0 = 7.2519e-04
Loss = 5.7856e-02, PNorm = 52.8523, GNorm = 0.3128, lr_0 = 7.5954e-04
Loss = 4.5557e-02, PNorm = 52.8989, GNorm = 0.1296, lr_0 = 7.9389e-04
Loss = 3.7961e-02, PNorm = 52.9463, GNorm = 0.0881, lr_0 = 8.2824e-04
Loss = 5.3565e-02, PNorm = 52.9770, GNorm = 0.1668, lr_0 = 8.6260e-04
Loss = 4.1684e-02, PNorm = 53.0426, GNorm = 0.1613, lr_0 = 8.9695e-04
Loss = 4.3761e-02, PNorm = 53.0807, GNorm = 0.0938, lr_0 = 9.3130e-04
Loss = 4.4214e-02, PNorm = 53.1613, GNorm = 0.0511, lr_0 = 9.6565e-04
Loss = 4.8131e-02, PNorm = 53.2134, GNorm = 0.0739, lr_0 = 1.0000e-03
Validation auc = 0.763332
Epoch 2
Loss = 4.1277e-02, PNorm = 53.2791, GNorm = 0.0736, lr_0 = 9.7827e-04
Loss = 4.6788e-02, PNorm = 53.3554, GNorm = 0.0755, lr_0 = 9.5701e-04
Loss = 3.5226e-02, PNorm = 53.4094, GNorm = 0.1277, lr_0 = 9.3621e-04
Loss = 4.1779e-02, PNorm = 53.4848, GNorm = 0.0699, lr_0 = 9.1587e-04
Loss = 4.3129e-02, PNorm = 53.5511, GNorm = 0.0959, lr_0 = 8.9596e-04
Loss = 3.8811e-02, PNorm = 53.6032, GNorm = 0.0483, lr_0 = 8.7649e-04
Loss = 4.6864e-02, PNorm = 53.6423, GNorm = 0.0814, lr_0 = 8.5744e-04
Loss = 4.9201e-02, PNorm = 53.6960, GNorm = 0.1714, lr_0 = 8.3881e-04
Loss = 4.6582e-02, PNorm = 53.7411, GNorm = 0.0759, lr_0 = 8.2058e-04
Loss = 4.1229e-02, PNorm = 53.7903, GNorm = 0.1230, lr_0 = 8.0275e-04
Loss = 5.2523e-02, PNorm = 53.8364, GNorm = 0.1048, lr_0 = 7.8530e-04
Loss = 4.5524e-02, PNorm = 53.8799, GNorm = 0.0925, lr_0 = 7.6824e-04
Loss = 3.4963e-02, PNorm = 53.9221, GNorm = 0.1242, lr_0 = 7.5154e-04
Validation auc = 0.840974
Epoch 3
Loss = 4.6359e-02, PNorm = 53.9878, GNorm = 0.0912, lr_0 = 7.3521e-04
Loss = 4.0539e-02, PNorm = 54.0366, GNorm = 0.0730, lr_0 = 7.1923e-04
Loss = 2.7445e-02, PNorm = 54.0872, GNorm = 0.1113, lr_0 = 7.0360e-04
Loss = 3.2712e-02, PNorm = 54.1261, GNorm = 0.1267, lr_0 = 6.8831e-04
Loss = 3.8417e-02, PNorm = 54.1833, GNorm = 0.0578, lr_0 = 6.7336e-04
Loss = 3.3987e-02, PNorm = 54.2113, GNorm = 0.0692, lr_0 = 6.5872e-04
Loss = 3.6687e-02, PNorm = 54.2432, GNorm = 0.0625, lr_0 = 6.4441e-04
Loss = 4.0980e-02, PNorm = 54.2766, GNorm = 0.0815, lr_0 = 6.3040e-04
Loss = 3.3919e-02, PNorm = 54.3014, GNorm = 0.0734, lr_0 = 6.1670e-04
Loss = 3.8330e-02, PNorm = 54.3264, GNorm = 0.1508, lr_0 = 6.0330e-04
Loss = 4.1635e-02, PNorm = 54.3791, GNorm = 0.0649, lr_0 = 5.9019e-04
Loss = 5.0846e-02, PNorm = 54.4092, GNorm = 0.0878, lr_0 = 5.7736e-04
Loss = 4.8848e-02, PNorm = 54.4352, GNorm = 0.0775, lr_0 = 5.6482e-04
Validation auc = 0.866697
Epoch 4
Loss = 4.1690e-02, PNorm = 54.4689, GNorm = 0.1175, lr_0 = 5.5254e-04
Loss = 4.1537e-02, PNorm = 54.4946, GNorm = 0.0725, lr_0 = 5.4054e-04
Loss = 3.8327e-02, PNorm = 54.5470, GNorm = 0.0544, lr_0 = 5.2879e-04
Loss = 4.9749e-02, PNorm = 54.5757, GNorm = 0.1331, lr_0 = 5.1730e-04
Loss = 5.4663e-02, PNorm = 54.5919, GNorm = 0.1215, lr_0 = 5.0606e-04
Loss = 3.2492e-02, PNorm = 54.6437, GNorm = 0.1869, lr_0 = 4.9506e-04
Loss = 4.6120e-02, PNorm = 54.6614, GNorm = 0.0714, lr_0 = 4.8430e-04
Loss = 3.7921e-02, PNorm = 54.6764, GNorm = 0.0760, lr_0 = 4.7378e-04
Loss = 2.8151e-02, PNorm = 54.7047, GNorm = 0.1447, lr_0 = 4.6348e-04
Loss = 2.4521e-02, PNorm = 54.7232, GNorm = 0.0614, lr_0 = 4.5341e-04
Loss = 3.6544e-02, PNorm = 54.7438, GNorm = 0.1003, lr_0 = 4.4355e-04
Loss = 4.2358e-02, PNorm = 54.7755, GNorm = 0.0786, lr_0 = 4.3391e-04
Loss = 3.6997e-02, PNorm = 54.8064, GNorm = 0.1035, lr_0 = 4.2449e-04
Validation auc = 0.878901
Epoch 5
Loss = 3.2254e-02, PNorm = 54.8238, GNorm = 0.0780, lr_0 = 4.1526e-04
Loss = 3.5447e-02, PNorm = 54.8446, GNorm = 0.0744, lr_0 = 4.0624e-04
Loss = 4.1010e-02, PNorm = 54.8734, GNorm = 0.0935, lr_0 = 3.9741e-04
Loss = 2.9297e-02, PNorm = 54.9032, GNorm = 0.0522, lr_0 = 3.8877e-04
Loss = 2.8194e-02, PNorm = 54.9211, GNorm = 0.0753, lr_0 = 3.8032e-04
Loss = 3.3741e-02, PNorm = 54.9414, GNorm = 0.0582, lr_0 = 3.7206e-04
Loss = 2.9929e-02, PNorm = 54.9576, GNorm = 0.1167, lr_0 = 3.6397e-04
Loss = 2.1617e-02, PNorm = 54.9715, GNorm = 0.0648, lr_0 = 3.5606e-04
Loss = 3.6622e-02, PNorm = 54.9844, GNorm = 0.1345, lr_0 = 3.4833e-04
Loss = 4.3065e-02, PNorm = 55.0037, GNorm = 0.1551, lr_0 = 3.4076e-04
Loss = 3.3565e-02, PNorm = 55.0224, GNorm = 0.0941, lr_0 = 3.3335e-04
Loss = 3.6103e-02, PNorm = 55.0473, GNorm = 0.0932, lr_0 = 3.2611e-04
Loss = 3.1035e-02, PNorm = 55.0864, GNorm = 0.0522, lr_0 = 3.1902e-04
Loss = 3.8554e-02, PNorm = 55.1051, GNorm = 0.1303, lr_0 = 3.1209e-04
Validation auc = 0.883312
Epoch 6
Loss = 3.0962e-02, PNorm = 55.1084, GNorm = 0.0849, lr_0 = 3.0530e-04
Loss = 3.9621e-02, PNorm = 55.1320, GNorm = 0.0663, lr_0 = 2.9867e-04
Loss = 2.9443e-02, PNorm = 55.1547, GNorm = 0.0385, lr_0 = 2.9218e-04
Loss = 4.2354e-02, PNorm = 55.1650, GNorm = 0.1125, lr_0 = 2.8583e-04
Loss = 3.7562e-02, PNorm = 55.1809, GNorm = 0.0957, lr_0 = 2.7962e-04
Loss = 3.1766e-02, PNorm = 55.2017, GNorm = 0.0702, lr_0 = 2.7354e-04
Loss = 3.6827e-02, PNorm = 55.2178, GNorm = 0.0739, lr_0 = 2.6760e-04
Loss = 3.3897e-02, PNorm = 55.2328, GNorm = 0.1822, lr_0 = 2.6178e-04
Loss = 2.9745e-02, PNorm = 55.2520, GNorm = 0.0516, lr_0 = 2.5609e-04
Loss = 2.4177e-02, PNorm = 55.2775, GNorm = 0.0776, lr_0 = 2.5053e-04
Loss = 3.4709e-02, PNorm = 55.2894, GNorm = 0.0624, lr_0 = 2.4508e-04
Loss = 2.7839e-02, PNorm = 55.3034, GNorm = 0.0654, lr_0 = 2.3976e-04
Loss = 3.2572e-02, PNorm = 55.3206, GNorm = 0.0641, lr_0 = 2.3455e-04
Validation auc = 0.882171
Epoch 7
Loss = 3.8225e-02, PNorm = 55.3448, GNorm = 0.0425, lr_0 = 2.2945e-04
Loss = 3.8192e-02, PNorm = 55.3699, GNorm = 0.1191, lr_0 = 2.2446e-04
Loss = 2.6425e-02, PNorm = 55.3800, GNorm = 0.1092, lr_0 = 2.1959e-04
Loss = 2.9063e-02, PNorm = 55.3984, GNorm = 0.0822, lr_0 = 2.1481e-04
Loss = 3.8542e-02, PNorm = 55.4165, GNorm = 0.2247, lr_0 = 2.1015e-04
Loss = 3.5068e-02, PNorm = 55.4313, GNorm = 0.1017, lr_0 = 2.0558e-04
Loss = 2.3394e-02, PNorm = 55.4544, GNorm = 0.0477, lr_0 = 2.0111e-04
Loss = 4.1296e-02, PNorm = 55.4514, GNorm = 0.1427, lr_0 = 1.9674e-04
Loss = 3.8510e-02, PNorm = 55.4607, GNorm = 0.1190, lr_0 = 1.9246e-04
Loss = 2.7365e-02, PNorm = 55.4795, GNorm = 0.0636, lr_0 = 1.8828e-04
Loss = 2.5387e-02, PNorm = 55.4924, GNorm = 0.0422, lr_0 = 1.8419e-04
Loss = 3.1551e-02, PNorm = 55.5048, GNorm = 0.0709, lr_0 = 1.8019e-04
Loss = 2.5540e-02, PNorm = 55.5164, GNorm = 0.0742, lr_0 = 1.7627e-04
Validation auc = 0.879734
Epoch 8
Loss = 2.5702e-02, PNorm = 55.5245, GNorm = 0.0465, lr_0 = 1.7244e-04
Loss = 3.5861e-02, PNorm = 55.5321, GNorm = 0.0847, lr_0 = 1.6869e-04
Loss = 3.6511e-02, PNorm = 55.5424, GNorm = 0.1258, lr_0 = 1.6503e-04
Loss = 2.8766e-02, PNorm = 55.5516, GNorm = 0.0836, lr_0 = 1.6144e-04
Loss = 3.0011e-02, PNorm = 55.5585, GNorm = 0.0913, lr_0 = 1.5793e-04
Loss = 3.4479e-02, PNorm = 55.5691, GNorm = 0.0682, lr_0 = 1.5450e-04
Loss = 4.0358e-02, PNorm = 55.5823, GNorm = 0.0799, lr_0 = 1.5114e-04
Loss = 2.6264e-02, PNorm = 55.5963, GNorm = 0.0973, lr_0 = 1.4786e-04
Loss = 2.7427e-02, PNorm = 55.6057, GNorm = 0.0592, lr_0 = 1.4465e-04
Loss = 2.8594e-02, PNorm = 55.6130, GNorm = 0.0733, lr_0 = 1.4150e-04
Loss = 3.2935e-02, PNorm = 55.6240, GNorm = 0.1085, lr_0 = 1.3843e-04
Loss = 2.4937e-02, PNorm = 55.6326, GNorm = 0.0716, lr_0 = 1.3542e-04
Loss = 3.3712e-02, PNorm = 55.6395, GNorm = 0.0863, lr_0 = 1.3248e-04
Validation auc = 0.879413
Epoch 9
Loss = 2.7538e-02, PNorm = 55.6456, GNorm = 0.0913, lr_0 = 1.2960e-04
Loss = 3.0791e-02, PNorm = 55.6537, GNorm = 0.1074, lr_0 = 1.2678e-04
Loss = 2.3298e-02, PNorm = 55.6619, GNorm = 0.0757, lr_0 = 1.2403e-04
Loss = 2.8137e-02, PNorm = 55.6709, GNorm = 0.1387, lr_0 = 1.2133e-04
Loss = 2.5497e-02, PNorm = 55.6756, GNorm = 0.0384, lr_0 = 1.1869e-04
Loss = 2.0354e-02, PNorm = 55.6811, GNorm = 0.0392, lr_0 = 1.1611e-04
Loss = 4.5760e-02, PNorm = 55.6853, GNorm = 0.0806, lr_0 = 1.1359e-04
Loss = 2.5292e-02, PNorm = 55.6925, GNorm = 0.0572, lr_0 = 1.1112e-04
Loss = 2.3057e-02, PNorm = 55.7003, GNorm = 0.1434, lr_0 = 1.0871e-04
Loss = 2.7029e-02, PNorm = 55.7044, GNorm = 0.0561, lr_0 = 1.0635e-04
Loss = 2.9411e-02, PNorm = 55.7121, GNorm = 0.1008, lr_0 = 1.0403e-04
Loss = 3.0863e-02, PNorm = 55.7196, GNorm = 0.1288, lr_0 = 1.0177e-04
Loss = 2.8525e-02, PNorm = 55.7271, GNorm = 0.0654, lr_0 = 1.0000e-04
Validation auc = 0.869392
Model 0 best validation auc = 0.883312 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Warning: Found a task with targets all 0s or all 1s
Model 0 test auc = 0.896446
Warning: Found a task with targets all 0s or all 1s
Ensemble test auc = nan
1-fold cross validation
	Seed 42 ==> test auc = nan
Overall test auc = nan +/- nan
Elapsed time = 0:01:16
Command line
python main_script.py train all_amine_split_for_paper --epochs 10
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 9,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [0.05, 0.05, 0.05, 0.05, 0.95, 0.95, 0.95, 0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/test_extra_x.csv'],
 'separate_test_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/valid_extra_x.csv'],
 'separate_val_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['Biodistribution_heart',
                    'Biodistribution_kidney',
                    'Biodistribution_liver',
                    'Biodistribution_lung',
                    'Biodistribution_lymph_nodes',
                    'Biodistribution_muscle',
                    'Biodistribution_spleen',
                    'quantified_delivery',
                    'quantified_total_luminescence'],
 'target_weights': None,
 'task_names': ['Biodistribution_heart',
                'Biodistribution_kidney',
                'Biodistribution_liver',
                'Biodistribution_lung',
                'Biodistribution_lymph_nodes',
                'Biodistribution_muscle',
                'Biodistribution_spleen',
                'quantified_delivery',
                'quantified_total_luminescence'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 9
Fold 0
Splitting data with seed 42
Total size = 6,612 | train size = 6,612 | val size = 1,721 | test size = 1,632
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=621, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=9, bias=True)
  )
)
Number of parameters = 1,628,409
Moving model to cuda
Epoch 0
Loss = 8.7445e-01, PNorm = 52.2046, GNorm = 3.0612, lr_0 = 1.3750e-04
Loss = 1.0434e+00, PNorm = 52.2058, GNorm = 2.9798, lr_0 = 1.7159e-04
Loss = 1.1113e+00, PNorm = 52.2095, GNorm = 2.2279, lr_0 = 2.0568e-04
Loss = 1.0006e+00, PNorm = 52.2146, GNorm = 2.2068, lr_0 = 2.3977e-04
Loss = 1.1106e+00, PNorm = 52.2204, GNorm = 2.1570, lr_0 = 2.7386e-04
Loss = 9.8737e-01, PNorm = 52.2296, GNorm = 2.0626, lr_0 = 3.0795e-04
Loss = 1.0051e+00, PNorm = 52.2409, GNorm = 1.6386, lr_0 = 3.4205e-04
Loss = 8.5884e-01, PNorm = 52.2505, GNorm = 2.3188, lr_0 = 3.7614e-04
Loss = 1.0232e+00, PNorm = 52.2653, GNorm = 2.8381, lr_0 = 4.1023e-04
Loss = 9.8218e-01, PNorm = 52.2781, GNorm = 1.6625, lr_0 = 4.4432e-04
Loss = 8.8811e-01, PNorm = 52.2936, GNorm = 1.0731, lr_0 = 4.7841e-04
Loss = 8.4409e-01, PNorm = 52.3108, GNorm = 1.1220, lr_0 = 5.1250e-04
Loss = 9.4848e-01, PNorm = 52.3271, GNorm = 1.2709, lr_0 = 5.4659e-04
Validation rmse = 0.191922
Epoch 1
Loss = 9.0564e-01, PNorm = 52.3499, GNorm = 1.4740, lr_0 = 5.8409e-04
Loss = 9.7743e-01, PNorm = 52.3757, GNorm = 2.1085, lr_0 = 6.1818e-04
Loss = 8.5900e-01, PNorm = 52.4021, GNorm = 1.3231, lr_0 = 6.5227e-04
Loss = 9.2112e-01, PNorm = 52.4287, GNorm = 1.2069, lr_0 = 6.8636e-04
Loss = 7.6989e-01, PNorm = 52.4556, GNorm = 1.2251, lr_0 = 7.2045e-04
Loss = 9.7247e-01, PNorm = 52.4860, GNorm = 1.3910, lr_0 = 7.5455e-04
Loss = 1.0599e+00, PNorm = 52.5123, GNorm = 1.2583, lr_0 = 7.8864e-04
Loss = 9.3477e-01, PNorm = 52.5518, GNorm = 2.0851, lr_0 = 8.2273e-04
Loss = 8.3075e-01, PNorm = 52.5835, GNorm = 0.6451, lr_0 = 8.5682e-04
Loss = 8.4123e-01, PNorm = 52.6206, GNorm = 1.0768, lr_0 = 8.9091e-04
Loss = 9.8214e-01, PNorm = 52.6498, GNorm = 1.3850, lr_0 = 9.2500e-04
Loss = 9.9273e-01, PNorm = 52.6907, GNorm = 1.5099, lr_0 = 9.5909e-04
Loss = 1.0057e+00, PNorm = 52.7357, GNorm = 1.2490, lr_0 = 9.9318e-04
Validation rmse = 0.195907
Epoch 2
Loss = 9.4161e-01, PNorm = 52.7936, GNorm = 1.1434, lr_0 = 9.8057e-04
Loss = 8.6046e-01, PNorm = 52.8300, GNorm = 0.7049, lr_0 = 9.5942e-04
Loss = 9.2744e-01, PNorm = 52.8502, GNorm = 0.5928, lr_0 = 9.3872e-04
Loss = 9.7561e-01, PNorm = 52.8910, GNorm = 1.2165, lr_0 = 9.1848e-04
Loss = 8.0916e-01, PNorm = 52.9305, GNorm = 0.8791, lr_0 = 8.9867e-04
Loss = 9.2735e-01, PNorm = 52.9644, GNorm = 1.4796, lr_0 = 8.7928e-04
Loss = 7.6094e-01, PNorm = 53.0105, GNorm = 1.1361, lr_0 = 8.6032e-04
Loss = 8.1511e-01, PNorm = 53.0373, GNorm = 1.0696, lr_0 = 8.4176e-04
Loss = 7.4989e-01, PNorm = 53.0800, GNorm = 1.5138, lr_0 = 8.2361e-04
Loss = 1.0147e+00, PNorm = 53.1087, GNorm = 1.5491, lr_0 = 8.0584e-04
Loss = 8.5572e-01, PNorm = 53.1439, GNorm = 1.7244, lr_0 = 7.8846e-04
Loss = 9.0524e-01, PNorm = 53.1861, GNorm = 1.3050, lr_0 = 7.7146e-04
Loss = 8.6248e-01, PNorm = 53.2276, GNorm = 0.6754, lr_0 = 7.5482e-04
Validation rmse = 0.194015
Epoch 3
Loss = 9.9941e-01, PNorm = 53.2672, GNorm = 1.3609, lr_0 = 7.3693e-04
Loss = 7.5830e-01, PNorm = 53.3190, GNorm = 0.8016, lr_0 = 7.2103e-04
Loss = 7.9610e-01, PNorm = 53.3472, GNorm = 1.5889, lr_0 = 7.0548e-04
Loss = 7.7144e-01, PNorm = 53.4005, GNorm = 0.8323, lr_0 = 6.9026e-04
Loss = 7.2927e-01, PNorm = 53.4302, GNorm = 1.1584, lr_0 = 6.7538e-04
Loss = 7.0656e-01, PNorm = 53.4653, GNorm = 1.3644, lr_0 = 6.6081e-04
Loss = 7.5227e-01, PNorm = 53.5030, GNorm = 0.7879, lr_0 = 6.4656e-04
Loss = 7.5709e-01, PNorm = 53.5234, GNorm = 1.0867, lr_0 = 6.3261e-04
Loss = 8.7237e-01, PNorm = 53.5587, GNorm = 1.0919, lr_0 = 6.1897e-04
Loss = 9.8433e-01, PNorm = 53.5901, GNorm = 1.5837, lr_0 = 6.0562e-04
Loss = 9.7985e-01, PNorm = 53.6232, GNorm = 0.8149, lr_0 = 5.9255e-04
Loss = 9.7793e-01, PNorm = 53.6600, GNorm = 1.0573, lr_0 = 5.7977e-04
Loss = 8.9726e-01, PNorm = 53.6834, GNorm = 0.7724, lr_0 = 5.6727e-04
Validation rmse = 0.198120
Epoch 4
Loss = 6.6595e-01, PNorm = 53.7138, GNorm = 0.7318, lr_0 = 5.5382e-04
Loss = 8.4519e-01, PNorm = 53.7527, GNorm = 0.9926, lr_0 = 5.4188e-04
Loss = 8.8877e-01, PNorm = 53.7846, GNorm = 1.2714, lr_0 = 5.3019e-04
Loss = 6.6300e-01, PNorm = 53.8178, GNorm = 0.7445, lr_0 = 5.1875e-04
Loss = 7.4235e-01, PNorm = 53.8459, GNorm = 1.2292, lr_0 = 5.0757e-04
Loss = 6.5604e-01, PNorm = 53.8700, GNorm = 0.7073, lr_0 = 4.9662e-04
Loss = 8.6318e-01, PNorm = 53.8905, GNorm = 1.1260, lr_0 = 4.8591e-04
Loss = 7.4148e-01, PNorm = 53.9226, GNorm = 1.2273, lr_0 = 4.7543e-04
Loss = 8.8622e-01, PNorm = 53.9466, GNorm = 0.9915, lr_0 = 4.6517e-04
Loss = 8.5030e-01, PNorm = 53.9661, GNorm = 1.0180, lr_0 = 4.5514e-04
Loss = 8.8934e-01, PNorm = 53.9922, GNorm = 2.4157, lr_0 = 4.4532e-04
Loss = 7.4653e-01, PNorm = 54.0171, GNorm = 1.1122, lr_0 = 4.3572e-04
Loss = 8.5801e-01, PNorm = 54.0404, GNorm = 1.0524, lr_0 = 4.2632e-04
Loss = 8.3882e-01, PNorm = 54.0704, GNorm = 1.2170, lr_0 = 4.1712e-04
Validation rmse = 0.187322
Epoch 5
Loss = 7.6921e-01, PNorm = 54.0961, GNorm = 1.1420, lr_0 = 4.0813e-04
Loss = 7.6165e-01, PNorm = 54.1140, GNorm = 1.0844, lr_0 = 3.9932e-04
Loss = 7.9519e-01, PNorm = 54.1357, GNorm = 1.3544, lr_0 = 3.9071e-04
Loss = 7.5924e-01, PNorm = 54.1703, GNorm = 1.2139, lr_0 = 3.8228e-04
Loss = 7.7011e-01, PNorm = 54.1933, GNorm = 0.8247, lr_0 = 3.7404e-04
Loss = 8.0018e-01, PNorm = 54.2126, GNorm = 1.3982, lr_0 = 3.6597e-04
Loss = 8.1198e-01, PNorm = 54.2324, GNorm = 0.8385, lr_0 = 3.5808e-04
Loss = 7.4141e-01, PNorm = 54.2462, GNorm = 0.7642, lr_0 = 3.5035e-04
Loss = 7.4244e-01, PNorm = 54.2662, GNorm = 0.9313, lr_0 = 3.4280e-04
Loss = 9.2382e-01, PNorm = 54.2888, GNorm = 1.6928, lr_0 = 3.3540e-04
Loss = 8.5809e-01, PNorm = 54.3116, GNorm = 1.4466, lr_0 = 3.2817e-04
Loss = 6.7431e-01, PNorm = 54.3277, GNorm = 0.8881, lr_0 = 3.2109e-04
Loss = 6.7150e-01, PNorm = 54.3392, GNorm = 1.3183, lr_0 = 3.1417e-04
Validation rmse = 0.179328
Epoch 6
Loss = 7.0124e-01, PNorm = 54.3556, GNorm = 0.9907, lr_0 = 3.0672e-04
Loss = 9.8401e-01, PNorm = 54.3788, GNorm = 1.2555, lr_0 = 3.0010e-04
Loss = 7.8720e-01, PNorm = 54.3997, GNorm = 1.9674, lr_0 = 2.9363e-04
Loss = 6.5387e-01, PNorm = 54.4151, GNorm = 1.0360, lr_0 = 2.8730e-04
Loss = 9.4518e-01, PNorm = 54.4338, GNorm = 1.2181, lr_0 = 2.8110e-04
Loss = 8.2840e-01, PNorm = 54.4521, GNorm = 1.0373, lr_0 = 2.7504e-04
Loss = 6.9974e-01, PNorm = 54.4667, GNorm = 0.9639, lr_0 = 2.6911e-04
Loss = 7.2117e-01, PNorm = 54.4768, GNorm = 0.9684, lr_0 = 2.6330e-04
Loss = 6.8249e-01, PNorm = 54.4909, GNorm = 1.3936, lr_0 = 2.5762e-04
Loss = 7.3574e-01, PNorm = 54.4967, GNorm = 0.7670, lr_0 = 2.5207e-04
Loss = 7.4952e-01, PNorm = 54.5101, GNorm = 1.6799, lr_0 = 2.4663e-04
Loss = 6.8100e-01, PNorm = 54.5221, GNorm = 1.2573, lr_0 = 2.4131e-04
Loss = 8.0270e-01, PNorm = 54.5366, GNorm = 1.1355, lr_0 = 2.3611e-04
Validation rmse = 0.181058
Epoch 7
Loss = 9.6696e-01, PNorm = 54.5561, GNorm = 1.3824, lr_0 = 2.3051e-04
Loss = 7.4421e-01, PNorm = 54.5734, GNorm = 1.2181, lr_0 = 2.2554e-04
Loss = 7.9286e-01, PNorm = 54.5877, GNorm = 1.1588, lr_0 = 2.2067e-04
Loss = 6.9987e-01, PNorm = 54.5947, GNorm = 0.7715, lr_0 = 2.1591e-04
Loss = 6.2732e-01, PNorm = 54.6008, GNorm = 0.7907, lr_0 = 2.1126e-04
Loss = 8.8064e-01, PNorm = 54.6132, GNorm = 1.2002, lr_0 = 2.0670e-04
Loss = 7.2045e-01, PNorm = 54.6333, GNorm = 1.0637, lr_0 = 2.0224e-04
Loss = 7.8771e-01, PNorm = 54.6428, GNorm = 0.9905, lr_0 = 1.9788e-04
Loss = 6.8264e-01, PNorm = 54.6535, GNorm = 1.3243, lr_0 = 1.9361e-04
Loss = 7.2241e-01, PNorm = 54.6662, GNorm = 0.9868, lr_0 = 1.8944e-04
Loss = 6.6152e-01, PNorm = 54.6731, GNorm = 0.8434, lr_0 = 1.8535e-04
Loss = 8.3268e-01, PNorm = 54.6808, GNorm = 0.8343, lr_0 = 1.8135e-04
Loss = 6.3743e-01, PNorm = 54.6911, GNorm = 0.8815, lr_0 = 1.7744e-04
Validation rmse = 0.178327
Epoch 8
Loss = 5.7557e-01, PNorm = 54.7015, GNorm = 1.0523, lr_0 = 1.7324e-04
Loss = 7.5639e-01, PNorm = 54.7104, GNorm = 1.1172, lr_0 = 1.6950e-04
Loss = 7.6135e-01, PNorm = 54.7187, GNorm = 1.2921, lr_0 = 1.6584e-04
Loss = 6.5765e-01, PNorm = 54.7244, GNorm = 0.8893, lr_0 = 1.6227e-04
Loss = 7.6838e-01, PNorm = 54.7326, GNorm = 1.1621, lr_0 = 1.5877e-04
Loss = 6.8993e-01, PNorm = 54.7435, GNorm = 1.2534, lr_0 = 1.5534e-04
Loss = 6.9895e-01, PNorm = 54.7579, GNorm = 1.0777, lr_0 = 1.5199e-04
Loss = 6.5727e-01, PNorm = 54.7680, GNorm = 1.3542, lr_0 = 1.4871e-04
Loss = 8.2218e-01, PNorm = 54.7769, GNorm = 1.2405, lr_0 = 1.4551e-04
Loss = 6.6635e-01, PNorm = 54.7839, GNorm = 1.3005, lr_0 = 1.4237e-04
Loss = 9.0975e-01, PNorm = 54.7917, GNorm = 1.4251, lr_0 = 1.3930e-04
Loss = 7.7822e-01, PNorm = 54.8022, GNorm = 1.4543, lr_0 = 1.3629e-04
Loss = 5.7967e-01, PNorm = 54.8113, GNorm = 1.0244, lr_0 = 1.3335e-04
Loss = 7.6232e-01, PNorm = 54.8156, GNorm = 1.5609, lr_0 = 1.3048e-04
Validation rmse = 0.177696
Epoch 9
Loss = 5.9753e-01, PNorm = 54.8216, GNorm = 0.9802, lr_0 = 1.2766e-04
Loss = 7.4080e-01, PNorm = 54.8279, GNorm = 1.2005, lr_0 = 1.2491e-04
Loss = 6.7244e-01, PNorm = 54.8320, GNorm = 0.8351, lr_0 = 1.2221e-04
Loss = 7.3350e-01, PNorm = 54.8387, GNorm = 1.0977, lr_0 = 1.1958e-04
Loss = 5.4007e-01, PNorm = 54.8467, GNorm = 0.9675, lr_0 = 1.1700e-04
Loss = 7.2098e-01, PNorm = 54.8528, GNorm = 1.3867, lr_0 = 1.1448e-04
Loss = 6.4297e-01, PNorm = 54.8564, GNorm = 0.8466, lr_0 = 1.1201e-04
Loss = 6.7539e-01, PNorm = 54.8636, GNorm = 0.8941, lr_0 = 1.0959e-04
Loss = 6.5209e-01, PNorm = 54.8710, GNorm = 0.7815, lr_0 = 1.0723e-04
Loss = 7.6838e-01, PNorm = 54.8766, GNorm = 1.1980, lr_0 = 1.0491e-04
Loss = 7.6735e-01, PNorm = 54.8817, GNorm = 1.9134, lr_0 = 1.0265e-04
Loss = 1.0362e+00, PNorm = 54.8839, GNorm = 0.7349, lr_0 = 1.0044e-04
Loss = 7.2832e-01, PNorm = 54.8904, GNorm = 1.2648, lr_0 = 1.0000e-04
Validation rmse = 0.175435
Model 0 best validation rmse = 0.175435 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.271831
Ensemble test rmse = 0.144726
1-fold cross validation
	Seed 42 ==> test rmse = 0.144726
Overall test rmse = 0.144726 +/- 0.000000
Elapsed time = 0:01:16
Command line
python main_script.py train all_amine_split_for_paper --epochs 10
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/train_clf.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 10,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 15,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.05,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95,
               0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4_clf',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/test_extra_x.csv'],
 'separate_test_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/test_clf.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/valid_extra_x.csv'],
 'separate_val_path': '/home/gongruyi/drug_delivery/LNP_ML_test/data/crossval_splits/all_amine_split_for_paper/cv_4/valid_clf.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': ['Encapsulation_Efficiency_EE<50',
                    'Encapsulation_Efficiency_50<=EE<80',
                    'Encapsulation_Efficiency_80<EE<=100',
                    'Delivery_target_lymph_nodes',
                    'chronic_toxicity_none',
                    'acute_toxicity_none',
                    'acute_toxicity_present',
                    'Delivery_target_dendritic_cell',
                    'Delivery_target_generic_cell',
                    'Delivery_target_macrophage',
                    'Delivery_target_lung_epithelium',
                    'Delivery_target_liver',
                    'Delivery_target_lung',
                    'Delivery_target_spleen',
                    'Delivery_target_muscle'],
 'target_weights': None,
 'task_names': ['Encapsulation_Efficiency_EE<50',
                'Encapsulation_Efficiency_50<=EE<80',
                'Encapsulation_Efficiency_80<EE<=100',
                'Delivery_target_lymph_nodes',
                'chronic_toxicity_none',
                'acute_toxicity_none',
                'acute_toxicity_present',
                'Delivery_target_dendritic_cell',
                'Delivery_target_generic_cell',
                'Delivery_target_macrophage',
                'Delivery_target_lung_epithelium',
                'Delivery_target_liver',
                'Delivery_target_lung',
                'Delivery_target_spleen',
                'Delivery_target_muscle'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 15
Fold 0
Splitting data with seed 42
Class sizes
Encapsulation_Efficiency_EE<50 0: 82.08%, 1: 17.92%
Encapsulation_Efficiency_50<=EE<80 0: 81.67%, 1: 18.33%
Encapsulation_Efficiency_80<EE<=100 0: 36.25%, 1: 63.75%
Delivery_target_lymph_nodes 0: 95.90%, 1: 4.10%
chronic_toxicity_none 0: 59.17%, 1: 40.83%
acute_toxicity_none 0: 58.75%, 1: 41.25%
acute_toxicity_present 0: 98.75%, 1: 1.25%
Delivery_target_dendritic_cell 0: 99.90%, 1: 0.10%
Delivery_target_generic_cell 0: 32.31%, 1: 67.69%
Delivery_target_macrophage 0: 99.69%, 1: 0.31%
Delivery_target_lung_epithelium 0: 80.20%, 1: 19.80%
Delivery_target_liver 0: 93.69%, 1: 6.31%
Delivery_target_lung 0: 99.72%, 1: 0.28%
Delivery_target_spleen 0: 98.23%, 1: 1.77%
Delivery_target_muscle 0: 96.75%, 1: 3.25%
Total size = 6,676 | train size = 6,676 | val size = 1,721 | test size = 1,632
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=621, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=15, bias=True)
  )
)
Number of parameters = 1,632,015
Moving model to cuda
Epoch 0
Loss = 5.6080e-01, PNorm = 52.3235, GNorm = 0.7935, lr_0 = 1.3722e-04
Loss = 2.4524e-01, PNorm = 52.3526, GNorm = 0.4821, lr_0 = 1.7105e-04
Loss = 2.0116e-01, PNorm = 52.3626, GNorm = 0.4144, lr_0 = 2.0489e-04
Loss = 1.6063e-01, PNorm = 52.3726, GNorm = 0.2346, lr_0 = 2.3872e-04
Loss = 1.1013e-01, PNorm = 52.3928, GNorm = 0.3829, lr_0 = 2.7256e-04
Loss = 1.0074e-01, PNorm = 52.4101, GNorm = 0.2333, lr_0 = 3.0639e-04
Loss = 6.9249e-02, PNorm = 52.4353, GNorm = 0.2323, lr_0 = 3.4023e-04
Loss = 8.0282e-02, PNorm = 52.4574, GNorm = 0.3724, lr_0 = 3.7406e-04
Loss = 6.8287e-02, PNorm = 52.4813, GNorm = 0.3466, lr_0 = 4.0789e-04
Loss = 5.8461e-02, PNorm = 52.5065, GNorm = 0.1851, lr_0 = 4.4173e-04
Loss = 6.1885e-02, PNorm = 52.5356, GNorm = 0.2917, lr_0 = 4.7556e-04
Loss = 4.0250e-02, PNorm = 52.5646, GNorm = 0.0848, lr_0 = 5.0940e-04
Loss = 5.5255e-02, PNorm = 52.5849, GNorm = 0.1714, lr_0 = 5.4323e-04
Validation auc = 0.789411
Epoch 1
Loss = 5.6349e-02, PNorm = 52.6139, GNorm = 0.1545, lr_0 = 5.8045e-04
Loss = 4.5977e-02, PNorm = 52.6428, GNorm = 0.1116, lr_0 = 6.1429e-04
Loss = 3.4108e-02, PNorm = 52.6790, GNorm = 0.1371, lr_0 = 6.4812e-04
Loss = 4.4184e-02, PNorm = 52.7071, GNorm = 0.2435, lr_0 = 6.8195e-04
Loss = 4.9428e-02, PNorm = 52.7344, GNorm = 0.1274, lr_0 = 7.1579e-04
Loss = 5.4136e-02, PNorm = 52.7899, GNorm = 0.1353, lr_0 = 7.4962e-04
Loss = 4.2128e-02, PNorm = 52.8416, GNorm = 0.1089, lr_0 = 7.8346e-04
Loss = 2.8556e-02, PNorm = 52.8898, GNorm = 0.0738, lr_0 = 8.1729e-04
Loss = 5.7882e-02, PNorm = 52.9320, GNorm = 0.1028, lr_0 = 8.5113e-04
Loss = 4.8596e-02, PNorm = 52.9836, GNorm = 0.1024, lr_0 = 8.8496e-04
Loss = 3.9559e-02, PNorm = 53.0683, GNorm = 0.0770, lr_0 = 9.1880e-04
Loss = 3.8222e-02, PNorm = 53.1283, GNorm = 0.1381, lr_0 = 9.5263e-04
Loss = 3.6481e-02, PNorm = 53.2129, GNorm = 0.0693, lr_0 = 9.8647e-04
Validation auc = 0.822768
Epoch 2
Loss = 3.1187e-02, PNorm = 53.2675, GNorm = 0.1076, lr_0 = 9.8710e-04
Loss = 4.6649e-02, PNorm = 53.3592, GNorm = 0.1407, lr_0 = 9.6597e-04
Loss = 3.7461e-02, PNorm = 53.4555, GNorm = 0.0882, lr_0 = 9.4529e-04
Loss = 4.5082e-02, PNorm = 53.5319, GNorm = 0.0788, lr_0 = 9.2505e-04
Loss = 4.7221e-02, PNorm = 53.5705, GNorm = 0.2353, lr_0 = 9.0525e-04
Loss = 4.4793e-02, PNorm = 53.6865, GNorm = 0.2072, lr_0 = 8.8587e-04
Loss = 4.6364e-02, PNorm = 53.7736, GNorm = 0.0622, lr_0 = 8.6690e-04
Loss = 3.6631e-02, PNorm = 53.8531, GNorm = 0.1052, lr_0 = 8.4834e-04
Loss = 3.6552e-02, PNorm = 53.9295, GNorm = 0.0788, lr_0 = 8.3018e-04
Loss = 3.8663e-02, PNorm = 53.9762, GNorm = 0.0841, lr_0 = 8.1241e-04
Loss = 2.8578e-02, PNorm = 54.0250, GNorm = 0.0586, lr_0 = 7.9502e-04
Loss = 4.0552e-02, PNorm = 54.0644, GNorm = 0.1879, lr_0 = 7.7800e-04
Loss = 2.6923e-02, PNorm = 54.1067, GNorm = 0.0625, lr_0 = 7.6134e-04
Loss = 3.2743e-02, PNorm = 54.1339, GNorm = 0.0669, lr_0 = 7.4504e-04
Loss = 2.7446e-02, PNorm = 54.1366, GNorm = 0.0740, lr_0 = 7.4343e-04
Validation auc = 0.831367
Epoch 3
Loss = 2.6499e-02, PNorm = 54.1751, GNorm = 0.0767, lr_0 = 7.2752e-04
Loss = 3.0722e-02, PNorm = 54.2160, GNorm = 0.1014, lr_0 = 7.1194e-04
Loss = 3.7309e-02, PNorm = 54.2707, GNorm = 0.0902, lr_0 = 6.9670e-04
Loss = 3.1134e-02, PNorm = 54.3118, GNorm = 0.0932, lr_0 = 6.8178e-04
Loss = 4.0723e-02, PNorm = 54.3473, GNorm = 0.0997, lr_0 = 6.6719e-04
Loss = 2.5609e-02, PNorm = 54.3925, GNorm = 0.0737, lr_0 = 6.5290e-04
Loss = 3.6529e-02, PNorm = 54.4305, GNorm = 0.1469, lr_0 = 6.3893e-04
Loss = 3.9286e-02, PNorm = 54.4675, GNorm = 0.0663, lr_0 = 6.2525e-04
Loss = 3.0031e-02, PNorm = 54.5173, GNorm = 0.0986, lr_0 = 6.1186e-04
Loss = 4.3624e-02, PNorm = 54.5367, GNorm = 0.0959, lr_0 = 5.9876e-04
Loss = 3.3488e-02, PNorm = 54.5770, GNorm = 0.0813, lr_0 = 5.8595e-04
Loss = 4.0517e-02, PNorm = 54.6215, GNorm = 0.0572, lr_0 = 5.7340e-04
Loss = 4.3043e-02, PNorm = 54.6474, GNorm = 0.1191, lr_0 = 5.6113e-04
Validation auc = 0.834069
Epoch 4
Loss = 4.1960e-02, PNorm = 54.6738, GNorm = 0.0941, lr_0 = 5.4911e-04
Loss = 2.9502e-02, PNorm = 54.7128, GNorm = 0.1174, lr_0 = 5.3736e-04
Loss = 3.1689e-02, PNorm = 54.7477, GNorm = 0.0426, lr_0 = 5.2585e-04
Loss = 3.3542e-02, PNorm = 54.7682, GNorm = 0.0962, lr_0 = 5.1460e-04
Loss = 3.3271e-02, PNorm = 54.8004, GNorm = 0.0974, lr_0 = 5.0358e-04
Loss = 3.2289e-02, PNorm = 54.8342, GNorm = 0.1467, lr_0 = 4.9280e-04
Loss = 3.8842e-02, PNorm = 54.8415, GNorm = 0.0782, lr_0 = 4.8225e-04
Loss = 2.9391e-02, PNorm = 54.8594, GNorm = 0.0926, lr_0 = 4.7192e-04
Loss = 3.5700e-02, PNorm = 54.8894, GNorm = 0.1053, lr_0 = 4.6182e-04
Loss = 2.9138e-02, PNorm = 54.9253, GNorm = 0.0641, lr_0 = 4.5193e-04
Loss = 3.6918e-02, PNorm = 54.9579, GNorm = 0.0752, lr_0 = 4.4226e-04
Loss = 3.3664e-02, PNorm = 54.9866, GNorm = 0.1048, lr_0 = 4.3279e-04
Loss = 3.8902e-02, PNorm = 55.0109, GNorm = 0.1113, lr_0 = 4.2353e-04
Validation auc = 0.827579
Epoch 5
Loss = 4.7991e-02, PNorm = 55.0196, GNorm = 0.0797, lr_0 = 4.1356e-04
Loss = 3.5519e-02, PNorm = 55.0464, GNorm = 0.0739, lr_0 = 4.0471e-04
Loss = 2.6910e-02, PNorm = 55.0810, GNorm = 0.1456, lr_0 = 3.9604e-04
Loss = 3.7793e-02, PNorm = 55.1122, GNorm = 0.0953, lr_0 = 3.8757e-04
Loss = 2.5285e-02, PNorm = 55.1473, GNorm = 0.0875, lr_0 = 3.7927e-04
Loss = 3.1747e-02, PNorm = 55.1780, GNorm = 0.0722, lr_0 = 3.7115e-04
Loss = 2.5517e-02, PNorm = 55.2069, GNorm = 0.0833, lr_0 = 3.6320e-04
Loss = 2.6378e-02, PNorm = 55.2105, GNorm = 0.0568, lr_0 = 3.5543e-04
Loss = 3.0039e-02, PNorm = 55.2358, GNorm = 0.0761, lr_0 = 3.4782e-04
Loss = 3.8225e-02, PNorm = 55.2720, GNorm = 0.0556, lr_0 = 3.4037e-04
Loss = 2.5279e-02, PNorm = 55.2985, GNorm = 0.0250, lr_0 = 3.3309e-04
Loss = 2.6765e-02, PNorm = 55.3149, GNorm = 0.1219, lr_0 = 3.2596e-04
Loss = 2.9313e-02, PNorm = 55.3245, GNorm = 0.0390, lr_0 = 3.1898e-04
Loss = 3.2052e-02, PNorm = 55.3633, GNorm = 0.1316, lr_0 = 3.1215e-04
Validation auc = 0.828166
Epoch 6
Loss = 2.0526e-02, PNorm = 55.3970, GNorm = 0.0209, lr_0 = 3.0547e-04
Loss = 2.3161e-02, PNorm = 55.3935, GNorm = 0.0523, lr_0 = 2.9893e-04
Loss = 3.4249e-02, PNorm = 55.4146, GNorm = 0.1370, lr_0 = 2.9253e-04
Loss = 3.4499e-02, PNorm = 55.4545, GNorm = 0.0796, lr_0 = 2.8626e-04
Loss = 2.5034e-02, PNorm = 55.4812, GNorm = 0.0408, lr_0 = 2.8014e-04
Loss = 4.0655e-02, PNorm = 55.5022, GNorm = 0.0857, lr_0 = 2.7414e-04
Loss = 3.0968e-02, PNorm = 55.5279, GNorm = 0.1110, lr_0 = 2.6827e-04
Loss = 3.0882e-02, PNorm = 55.5386, GNorm = 0.0975, lr_0 = 2.6253e-04
Loss = 2.5651e-02, PNorm = 55.5581, GNorm = 0.0821, lr_0 = 2.5691e-04
Loss = 2.6307e-02, PNorm = 55.5815, GNorm = 0.0390, lr_0 = 2.5141e-04
Loss = 2.7262e-02, PNorm = 55.5925, GNorm = 0.0692, lr_0 = 2.4602e-04
Loss = 2.2991e-02, PNorm = 55.6051, GNorm = 0.0293, lr_0 = 2.4076e-04
Loss = 2.5143e-02, PNorm = 55.6199, GNorm = 0.0667, lr_0 = 2.3560e-04
Validation auc = 0.822831
Epoch 7
Loss = 1.8477e-02, PNorm = 55.6315, GNorm = 0.0589, lr_0 = 2.3006e-04
Loss = 2.5334e-02, PNorm = 55.6458, GNorm = 0.0457, lr_0 = 2.2514e-04
Loss = 3.8258e-02, PNorm = 55.6592, GNorm = 0.1132, lr_0 = 2.2032e-04
Loss = 2.5997e-02, PNorm = 55.6591, GNorm = 0.0415, lr_0 = 2.1560e-04
Loss = 2.0316e-02, PNorm = 55.6698, GNorm = 0.0561, lr_0 = 2.1098e-04
Loss = 2.5642e-02, PNorm = 55.6842, GNorm = 0.0761, lr_0 = 2.0647e-04
Loss = 3.5597e-02, PNorm = 55.7007, GNorm = 0.1071, lr_0 = 2.0205e-04
Loss = 2.5244e-02, PNorm = 55.7167, GNorm = 0.0907, lr_0 = 1.9772e-04
Loss = 2.0470e-02, PNorm = 55.7314, GNorm = 0.0719, lr_0 = 1.9349e-04
Loss = 2.4143e-02, PNorm = 55.7448, GNorm = 0.0945, lr_0 = 1.8935e-04
Loss = 2.3894e-02, PNorm = 55.7554, GNorm = 0.0941, lr_0 = 1.8529e-04
Loss = 2.7366e-02, PNorm = 55.7639, GNorm = 0.0983, lr_0 = 1.8133e-04
Loss = 1.4996e-02, PNorm = 55.7720, GNorm = 0.0386, lr_0 = 1.7744e-04
Validation auc = 0.824417
Epoch 8
Loss = 2.1523e-02, PNorm = 55.7794, GNorm = 0.0841, lr_0 = 1.7364e-04
Loss = 2.7357e-02, PNorm = 55.7825, GNorm = 0.0819, lr_0 = 1.6993e-04
Loss = 2.0083e-02, PNorm = 55.7882, GNorm = 0.0393, lr_0 = 1.6629e-04
Loss = 2.1034e-02, PNorm = 55.8025, GNorm = 0.1158, lr_0 = 1.6273e-04
Loss = 3.1582e-02, PNorm = 55.8103, GNorm = 0.1198, lr_0 = 1.5925e-04
Loss = 2.8098e-02, PNorm = 55.8159, GNorm = 0.0342, lr_0 = 1.5584e-04
Loss = 2.3589e-02, PNorm = 55.8242, GNorm = 0.0908, lr_0 = 1.5250e-04
Loss = 2.5513e-02, PNorm = 55.8360, GNorm = 0.0810, lr_0 = 1.4924e-04
Loss = 2.3722e-02, PNorm = 55.8438, GNorm = 0.2224, lr_0 = 1.4604e-04
Loss = 3.6240e-02, PNorm = 55.8446, GNorm = 0.1038, lr_0 = 1.4291e-04
Loss = 1.9444e-02, PNorm = 55.8511, GNorm = 0.0384, lr_0 = 1.3985e-04
Loss = 2.9786e-02, PNorm = 55.8617, GNorm = 0.0936, lr_0 = 1.3686e-04
Loss = 2.6171e-02, PNorm = 55.8750, GNorm = 0.0809, lr_0 = 1.3393e-04
Loss = 2.1816e-02, PNorm = 55.8831, GNorm = 0.0244, lr_0 = 1.3106e-04
Validation auc = 0.828137
Epoch 9
Loss = 2.1475e-02, PNorm = 55.8896, GNorm = 0.0701, lr_0 = 1.2798e-04
Loss = 2.9625e-02, PNorm = 55.8967, GNorm = 0.1080, lr_0 = 1.2524e-04
Loss = 2.6570e-02, PNorm = 55.8999, GNorm = 0.0422, lr_0 = 1.2256e-04
Loss = 2.4471e-02, PNorm = 55.9022, GNorm = 0.0877, lr_0 = 1.1994e-04
Loss = 2.4896e-02, PNorm = 55.9059, GNorm = 0.0585, lr_0 = 1.1737e-04
Loss = 2.0823e-02, PNorm = 55.9097, GNorm = 0.2069, lr_0 = 1.1486e-04
Loss = 3.1270e-02, PNorm = 55.9139, GNorm = 0.0502, lr_0 = 1.1240e-04
Loss = 2.7502e-02, PNorm = 55.9185, GNorm = 0.1766, lr_0 = 1.0999e-04
Loss = 2.4392e-02, PNorm = 55.9212, GNorm = 0.0640, lr_0 = 1.0764e-04
Loss = 1.9524e-02, PNorm = 55.9290, GNorm = 0.0685, lr_0 = 1.0533e-04
Loss = 2.4738e-02, PNorm = 55.9375, GNorm = 0.1313, lr_0 = 1.0308e-04
Loss = 1.6434e-02, PNorm = 55.9410, GNorm = 0.0198, lr_0 = 1.0087e-04
Loss = 2.3580e-02, PNorm = 55.9467, GNorm = 0.1268, lr_0 = 1.0000e-04
Validation auc = 0.827566
Model 0 best validation auc = 0.834069 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test auc = 0.835755
Ensemble test auc = 0.835755
1-fold cross validation
	Seed 42 ==> test auc = 0.835755
Overall test auc = 0.835755 +/- 0.000000
Elapsed time = 0:01:17
